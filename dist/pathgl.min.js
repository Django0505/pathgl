!function(){function t(e){function n(n){return e=n,J=s(e),Q=u(t.vertexShader,t.fragmentShader),c(e),i(e),r(e),d3.timer(W),J?e:null}function r(){J.disable(J.SCISSOR_TEST),J.colorMask(!0,!0,!0,!0),J.stencilMask(1,1,1,1),J.disable(J.BLEND),J.enable(J.CULL_FACE)}function i(t){d3.select(t).on("mousemove.pathgl",o)}function o(){var e=d3.mouse(this);t.uniforms.mouse=[e[0]/innerWidth,e[1]/innerHeight]}function c(t){return j(t,{appendChild:O,querySelectorAll:B,querySelector:function(t){return this.querySelectorAll(t)[0]},removeChild:M,insertBefore:Y,gl:J,__scene__:[],__pos__:[],__program__:void 0})}function a(t,e){var n=J.createShader(t);if(J.shaderSource(n,e),J.compileShader(n),!J.getShaderParameter(n,J.COMPILE_STATUS))throw e+" "+J.getShaderInfoLog(n);return n}function u(t,e){if(Q=J.createProgram(),t=a(J.VERTEX_SHADER,t),e=a(J.FRAGMENT_SHADER,e),J.attachShader(Q,t),J.attachShader(Q,e),J.deleteShader(t),J.deleteShader(e),J.linkProgram(Q),J.useProgram(Q),!J.getProgramParameter(Q,J.LINK_STATUS))throw name+": "+J.getProgramInfoLog(Q);return K({},f),Q.vPos=J.getAttribLocation(Q,"pos"),J.enableVertexAttribArray(Q.vPos),Q.vfill=J.getAttribLocation(Q,"fill"),J.enableVertexAttribArray(Q.vFill),Q.vStroke=J.getAttribLocation(Q,"stroke"),J.enableVertexAttribArray(Q.vStroke),Q}function f(t,e){var n=J.getUniformLocation(Q,e);(Q["set"+e]=function(e){J["uniform"+t.length+"fv"](n,Array.isArray(e)?e:[e])})(t)}function s(t){var e=t.getContext("webgl")||t.getContext("experimental-webgl");return e&&j(e,{viewportWidth:t.width,viewportHeight:t.height})}function l(){}function h(){}function d(){}function _(){}function A(){}function v(){}function p(){}function g(t){var e=[];return z(t,function(t,n){e.push([t,n,0])}),e}function b(t){var e=addToBuffer(this);if(e.length)return render();t.match(/[a-z][^a-z]*/gi).forEach(function(t,n,r){var i=ne[t[0].toLowerCase()],o=t.slice(1).trim().split(/,| /g);return[].push.apply(e.coords,g(o)),i?"closePath"==i.name&&r[n+1]?i.call(e,r[n+1]):("function"==typeof i?1==o.length?i.call(e):z(o,i,e):console.error(i+" "+t[0]+" is not yet implemented"),void 0):void 0});var n=toBuffer(this.path.coords);this.path.length=0,this.path.push(n)}function R(t,e){pos=[t,e]}function m(t){ee=pos,E.apply(this,/m/i.test(t)?t.slice(1).trim().split(/,| /g):this.coords[0])}function E(t,e){this.push(t,e,0)}function F(){re.count&&(J.bindBuffer(J.ARRAY_BUFFER,J.createBuffer()),J.enableVertexAttribArray(Q.vPos),J.bufferData(J.ARRAY_BUFFER,ie,J.DYNAMIC_DRAW),J.vertexAttribPointer(Q.vPos,4,J.FLOAT,!1,0,0),J.bindBuffer(J.ARRAY_BUFFER,J.createBuffer()),J.enableVertexAttribArray(Q.vStroke),J.bufferData(J.ARRAY_BUFFER,te,J.DYNAMIC_DRAW),J.vertexAttribPointer(Q.vStroke,1,J.FLOAT,!1,0,0),J.bindBuffer(J.ARRAY_BUFFER,J.createBuffer()),J.enableVertexAttribArray(Q.vFill),J.bufferData(J.ARRAY_BUFFER,te,J.DYNAMIC_DRAW),J.vertexAttribPointer(Q.vFill,1,J.FLOAT,!1,0,0),J.bindBuffer(J.ELEMENT_ARRAY_BUFFER,J.createBuffer()),J.bufferData(J.ELEMENT_ARRAY_BUFFER,re,J.DYNAMIC_DRAW),J.drawElements(J.POINTS,4e4,J.UNSIGNED_SHORT,0))}function S(){J.bindBuffer(J.ARRAY_BUFFER,J.createBuffer()),J.enableVertexAttribArray(Q.vPos),J.bufferData(J.ARRAY_BUFFER,ce,J.DYNAMIC_DRAW),J.vertexAttribPointer(Q.vPos,2,J.FLOAT,!1,0,0),J.bindBuffer(J.ARRAY_BUFFER,J.createBuffer()),J.enableVertexAttribArray(Q.vStroke),J.bufferData(J.ARRAY_BUFFER,te,J.DYNAMIC_DRAW),J.vertexAttribPointer(Q.vStroke,1,J.FLOAT,!1,0,0),J.bindBuffer(J.ARRAY_BUFFER,J.createBuffer()),J.enableVertexAttribArray(Q.vFill),J.bufferData(J.ARRAY_BUFFER,te,J.DYNAMIC_DRAW),J.vertexAttribPointer(Q.vFill,1,J.FLOAT,!1,0,0),J.bindBuffer(J.ELEMENT_ARRAY_BUFFER,J.createBuffer()),J.bufferData(J.ELEMENT_ARRAY_BUFFER,oe,J.DYNAMIC_DRAW),J.drawElements(J.LINES,4*oe.count,J.UNSIGNED_SHORT,0)}function y(){}function B(t,e){return t.replace(/^\s+|\s*([,\s\+\~>]|$)\s*/g,"$1").split(",").forEach(function(t){x(t,this).forEach(X.bind(e))},this,e=[])||e}function x(t,e){var n,r=t.split(/[\s\>\+\~](?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),i=t.match(/([\s\>\+\~])(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),o=T(r.pop()),c=[],a=[];return N.call(e,o[1]||"*").forEach(function(t){(n=D.apply(t,o))&&c.push(n)}),r.length?c.forEach(function(t){w(t,r,i)&&a.push(t)})||a:c}function w(t,e,n,r){return r=function i(t,o,c){for(;c=ue[n[o]](c,t);)if(D.apply(c,T(e[o]))&&o)return(r=i(c,o-1,c))?r:c}(t,e.length-1,t)}function D(t,e,n,r,i,o,c,t,a,t,u,f){return a&&ae[a]&&!ae[a](this,u)||e&&"*"!==e&&this.tag&&this.tag.toLowerCase()!==e||r&&!L(o,this[i]||"",c)||n&&(f=n.match(/#([\w\-]+)/))&&f[1]!==this.id||n&&(n.match(/\.[\w\-]+/g)||[]).some(U.bind(this))?0:this}function L(t,e,n){return e.match(RegExp({"=":n,"^=":"^"+P(n),"$=":P(n)+"$","*=":P(n),"~=":"(?:^|\\s+)"+P(n)+"(?:\\s+|$)","|=":"^"+P(n)+"(-|$)"}[t]||"adnan^"))}function T(t){return t.match(fe)}function C(t){for(;t=t.previousSibling();)if(t.top)return t}function P(t){return t.replace(/([.*+?\^=!:${}()|\[\]\/\\])/,"\\$1")}function U(t){return!RegExp("(^|\\s+)"+t.slice(1)+"(\\s+|$)").test(this.class)}function N(t){return I(this,function(e){return"*"==t||e.tag==t},[])}function I(t,e,n){return(t.__scene__||t.children).forEach(function(t){I(t,e,n),e(t)&&n.push(t)})||n}function k(){b.call(this,this.attr.d),this.buffer=toBuffer(this.path.coords)}function Y(t,n){var r=e.__scene__,i=r.indexOf(n);reverseEach(r.slice(i,r.push(0)),function(t,e){r[e]=r[e-1]}),r[i]=t}function O(t){return Ae[t.tagName.toLowerCase()](t)}function M(t){var e=this.__scene__.indexOf(t);this.__scene__.splice(e,1);for(var n=0;4>n;n++)t.buffer[t.index+n]=0;t.buffer.changed=!0,t.buffer.count-=1}function $(t){return function(n){var r=new t,i=r.buffer;e.__scene__.push(r),r.attr=Object.create(ve),r.tag=n.tagName.toLowerCase(),r.parentNode=r.parentElement=e;var o=r.indices="line"==t.name?[i.count,i.count+1]:[4*i.count];return o.forEach(function(t){i[t]=i.count+t%2}),i.count+="line"==t.name?2:1,r}}function V(t){pe[t]||(d3.select("canvas").on(t,function(){this.__scene__.filter(function(){})}),pe[t]=[]),pe[t].push(this.id)}function W(t){return q(t),F(t),S(t),y(t),Z}function q(){J.clear(J.DEPTH_BUFFER_BIT|J.STENCIL_BUFFER_BIT),J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT|J.STENCIL_BUFFER_BIT)}function H(){}function j(t,e){if(arguments.length>2)[].forEach.call(arguments,function(e){j(t,e)});else for(var n in e)t[n]=e[n];return t}function z(t,e,n){for(var r=t.length-1,i=0;r>i;)e.call(n,t[i++],t[i++])}function G(){return!1}function K(t,e){for(var n in t)e(t[n],n,t)}function X(t){return this.push(t)}var J,Q;if(e="string"==typeof e?document.querySelector(e):e instanceof d3.selection?e.node():e,!e.getContext)return console.log(e,"is not a valid canvas");t.vertexShader=["precision mediump float;","attribute vec4 pos;","attribute float fill;","attribute float stroke;","varying vec4 v_stroke;","varying vec4 v_fill;","vec3 unpack_color(float col) {","    if (col == 0.) return vec3(0);","    return vec3(mod(col / 256. / 256., 256.),","                mod(col / 256. , 256.),","                mod(col, 256.)) / 256.; }","void main() {","    gl_Position = vec4(pos.xy, 1., 1.);","    gl_PointSize =  pos.z * 2.;","    v_fill = vec4(unpack_color(fill), 1.0);","    v_stroke = vec4(unpack_color(stroke), 1.0);","}"].join("\n"),t.fragmentShader=["precision mediump float;","varying vec4 v_stroke;","varying vec4 v_fill;","void main() {","    float dist = distance(gl_PointCoord, vec2(0.5));","    gl_FragColor = v_stroke;","}"].join("\n");var Z=!1,te=new Float32Array(4e4);t.uniforms={mouse:[0,0]},t.stop=function(){Z=!0};var ee,ne={m:R,z:m,l:E,h:l,v:h,c:d,s:_,q:A,t:v,a:p},re=new Uint16Array(4e4),ie=new Float32Array(4e4);re.count=0,pb=re,ppb=ie,cb=te;var oe=new Uint16Array(4e4),ce=new Float32Array(4e4);oe.count=0,lb=oe,lpb=ce;var ae={},ue={" ":function(t){return t&&t!==__scene__&&t.parent()},">":function(t,e){return t&&t.parent()==e.parent()&&t.parent()},"~":function(t){return t&&t.previousSibling()},"+":function(t,e,n,r){return!t||(n=C(t))&&(r=C(e))&&n==r&&n}},fe=/^(\*|\w+)?(?:([\.\#]+[\w\-\.#]+)?)(\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\])?(:([\w\-]+)(\(['"]?([^()]+)['"]?\))?)?/;d3.scale.linear().domain([0,e.width]).range([-1,1]),d3.scale.linear().domain([0,e.height]).range([1,-1]);var se=function(t){return 2*(t/e.width)-1},le=function(t){return 1-2*(t/e.height)},he={circle:{r:function(t){ie[this.indices[0]+2]=t},cx:function(t){ie[this.indices[0]+0]=se(t)},cy:function(t){ie[this.indices[0]+1]=le(t)},fill:function(t){var e=d3.rgb(t);te[this.indices[0]/4]=parseInt(e.toString().slice(1),16)},stroke:function(t){return},opacity:function(){},buffer:re},ellipse:{cx:H,cy:H,rx:H,ry:H},rect:{width:H,height:H,x:H,y:H,rx:_e,ry:_e},image:{"xlink:href":H,height:H,width:H,x:H,y:H},line:{x1:function(t){ce[2*this.indices[0]]=se(t)},y1:function(t){ce[2*this.indices[0]+1]=le(t)},x2:function(t){ce[2*this.indices[1]]=se(t)},y2:function(t){ce[2*this.indices[1]+1]=le(t)},buffer:oe,stroke:function(t){var e=d3.rgb(t);this.indices.forEach(function(t){te[t]=parseInt(e.toString().slice(1),16)})}},path:{d:k,pathLength:k},polygon:{points:H},polyline:{points:H},g:{appendChild:function(t){this.children.push(O(t))},ctr:function(){this.children=[]}},text:{x:H,y:H,dx:H,dy:H}},de=j(Object.create(null),{querySelectorAll:B,children:Object.freeze([]),ctr:$,querySelector:function(t){return this.querySelectorAll(t)[0]},createElementNS:H,insertBefore:H,ownerDocument:{createElementNS:H},render:function(){this.buffer&&drawFill(this),drawStroke(this)},previousSibling:function(){e.scene[e.__scene__.indexOf(this)-1]},nextSibling:function(){e.scene[e.__scene__.indexOf()+1]},parent:function(){return __scene__},fill:function(t){G(t)&&initShader(d3.select(t).text(),t)},transform:function(t){var e=d3.transform(t),n=e.rotate*Math.PI/180;e.rotate&&delete e.translate,j(this.attr,e,{rotation:[Math.sin(n),Math.cos(n)]})},stroke:function(t){G(t)&&initShader(d3.select(t).text(),t)},getAttribute:function(t){return this.attr[t]},setAttribute:function(t,e){this.attr[t]=e,this[t]&&this[t](e)},style:{setProperty:H},removeAttribute:function(t){delete this.attr[t]},textContent:H,removeEventListener:H,addEventListener:V}),_e=H,Ae=[function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}].reduce(function(t,e){return t[e.name]=$(e),e.prototype=j(Object.create(de),he[e.name]),t},{}),ve={rotation:[0,1],translate:[0,0],scale:[1,1],fill:0,stroke:0,"stroke-width":2,cx:0,cy:0,x:0,y:0,opacity:.999},pe={},ge=(Date.now(),{});return t.frameCounter=ge,n(e)}this.pathgl=t,t.stop=d3.functor()}();