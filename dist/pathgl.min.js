!function(){function t(e){function n(n){return e=n,Q=s(e),Z=u(t.vertexShader,t.fragmentShader),c(e),i(e),r(e),d3.timer(W),Q?e:null}function r(){Q.disable(Q.SCISSOR_TEST),Q.colorMask(!0,!0,!0,!0),Q.stencilMask(1,1,1,1),Q.disable(Q.BLEND),Q.enable(Q.CULL_FACE)}function i(t){d3.select(t).on("mousemove.pathgl",o)}function o(){var e=d3.mouse(this);t.uniforms.mouse=[e[0]/innerWidth,e[1]/innerHeight]}function c(t){return j(t,{appendChild:O,querySelectorAll:x,querySelector:function(t){return this.querySelectorAll(t)[0]},removeChild:M,insertBefore:Y,gl:Q,__scene__:[],__pos__:[],__program__:void 0})}function a(t,e){var n=Q.createShader(t);if(Q.shaderSource(n,e),Q.compileShader(n),!Q.getShaderParameter(n,Q.COMPILE_STATUS))throw e+" "+Q.getShaderInfoLog(n);return n}function u(t,e){if(Z=Q.createProgram(),t=a(Q.VERTEX_SHADER,t),e=a(Q.FRAGMENT_SHADER,e),Q.attachShader(Z,t),Q.attachShader(Z,e),Q.deleteShader(t),Q.deleteShader(e),Q.linkProgram(Z),Q.useProgram(Z),!Q.getProgramParameter(Z,Q.LINK_STATUS))throw name+": "+Q.getProgramInfoLog(Z);return K({},f),Z.vPos=Q.getAttribLocation(Z,"pos"),Q.enableVertexAttribArray(Z.vPos),Z.vFill=Q.getAttribLocation(Z,"fill"),Q.enableVertexAttribArray(Z.vFill),Z.vStroke=Q.getAttribLocation(Z,"stroke"),Q.enableVertexAttribArray(Z.vStroke),Z}function f(t,e){var n=Q.getUniformLocation(Z,e);(Z["set"+e]=function(e){Q["uniform"+t.length+"fv"](n,Array.isArray(e)?e:[e])})(t)}function s(t){var e=t.getContext("webgl")||t.getContext("experimental-webgl");return e&&j(e,{viewportWidth:t.width,viewportHeight:t.height})}function l(){}function h(){}function d(){}function _(){}function v(){}function g(){}function p(){}function A(t){var e=[];return z(t,function(t,n){e.push(+t,+n)}),e}function b(t){var e=[];return t.match(/[a-z][^a-z]*/gi).forEach(function(t){var n=(ne[t[0].toLowerCase()],t.slice(1).trim().split(/,| /g));[].push.apply(e,A(n))}),e}function m(t,e){ie=[t,e]}function E(t){re=ie,R.apply(this,/m/i.test(t)?t.slice(1).trim().split(/,| /g):this.coords[0])}function R(t,e){this.push(ie[0],ie[1],e,0),ie=[t,e]}function y(){oe.count&&(Q.bindBuffer(Q.ARRAY_BUFFER,Q.createBuffer()),Q.enableVertexAttribArray(Z.vPos),Q.bufferData(Q.ARRAY_BUFFER,ce,Q.DYNAMIC_DRAW),Q.vertexAttribPointer(Z.vPos,4,Q.FLOAT,!1,0,0),Q.bindBuffer(Q.ARRAY_BUFFER,Q.createBuffer()),Q.enableVertexAttribArray(Z.vStroke),Q.bufferData(Q.ARRAY_BUFFER,ee,Q.DYNAMIC_DRAW),Q.vertexAttribPointer(Z.vStroke,1,Q.FLOAT,!1,0,0),Q.bindBuffer(Q.ARRAY_BUFFER,Q.createBuffer()),Q.enableVertexAttribArray(Z.vFill),Q.bufferData(Q.ARRAY_BUFFER,ee,Q.DYNAMIC_DRAW),Q.vertexAttribPointer(Z.vFill,1,Q.FLOAT,!1,0,0),Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,Q.createBuffer()),Q.bufferData(Q.ELEMENT_ARRAY_BUFFER,oe,Q.DYNAMIC_DRAW),Q.drawElements(Q.POINTS,4*oe.count,Q.UNSIGNED_SHORT,0))}function S(){Q.bindBuffer(Q.ARRAY_BUFFER,Q.createBuffer()),Q.enableVertexAttribArray(Z.vPos),Q.bufferData(Q.ARRAY_BUFFER,ue,Q.DYNAMIC_DRAW),Q.vertexAttribPointer(Z.vPos,2,Q.FLOAT,!1,0,0),Q.bindBuffer(Q.ARRAY_BUFFER,Q.createBuffer()),Q.enableVertexAttribArray(Z.vStroke),Q.bufferData(Q.ARRAY_BUFFER,ee,Q.DYNAMIC_DRAW),Q.vertexAttribPointer(Z.vStroke,1,Q.FLOAT,!1,0,0),Q.disableVertexAttribArray(Z.vFill),Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,Q.createBuffer()),Q.bufferData(Q.ELEMENT_ARRAY_BUFFER,ae,Q.DYNAMIC_DRAW),Q.drawElements(Q.LINES,4*ae.count,Q.UNSIGNED_SHORT,0)}function F(){}function x(t,e){return t.replace(/^\s+|\s*([,\s\+\~>]|$)\s*/g,"$1").split(",").forEach(function(t){w(t,this).forEach(X.bind(e))},this,e=[])||e}function w(t,e){var n,r=t.split(/[\s\>\+\~](?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),i=t.match(/([\s\>\+\~])(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),o=k(r.pop()),c=[],a=[];return N.call(e,o[1]||"*").forEach(function(t){(n=L.apply(t,o))&&c.push(n)}),r.length?c.forEach(function(t){B(t,r,i)&&a.push(t)})||a:c}function B(t,e,n,r){return r=function i(t,o,c){for(;c=se[n[o]](c,t);)if(L.apply(c,k(e[o]))&&o)return(r=i(c,o-1,c))?r:c}(t,e.length-1,t)}function L(t,e,n,r,i,o,c,t,a,t,u,f){return a&&fe[a]&&!fe[a](this,u)||e&&"*"!==e&&this.tag&&this.tag.toLowerCase()!==e||r&&!D(o,this[i]||"",c)||n&&(f=n.match(/#([\w\-]+)/))&&f[1]!==this.id||n&&(n.match(/\.[\w\-]+/g)||[]).some(I.bind(this))?0:this}function D(t,e,n){return e.match(RegExp({"=":n,"^=":"^"+T(n),"$=":T(n)+"$","*=":T(n),"~=":"(?:^|\\s+)"+T(n)+"(?:\\s+|$)","|=":"^"+T(n)+"(-|$)"}[t]||"adnan^"))}function k(t){return t.match(le)}function C(t){for(;t=t.previousSibling();)if(t.top)return t}function T(t){return t.replace(/([.*+?\^=!:${}()|\[\]\/\\])/,"\\$1")}function I(t){return!RegExp("(^|\\s+)"+t.slice(1)+"(\\s+|$)").test(this.class)}function N(t){return P(this,function(e){return"*"==t||e.tag==t},[])}function P(t,e,n){return(t.__scene__||t.children).forEach(function(t){P(t,e,n),e(t)&&n.push(t)})||n}function U(t){var e=b(t);this.indices.length>e.length&&([].push.apply[this.indices,J(e.length,this.buffer.count)],this.buffer.length+=this.indices.length-e.length),this.indices.length<e.length&&(this.indices.length=e.length,this.buffer.length+=e.length-this.indices.length),this.indices.forEach(function(t){e[t]=e.count+t%2,e.count+=2,ue[t]=e[t],ue[t+1]=e[t+1]}),this.stroke(this.attr.stroke)}function Y(t,n){var r=e.__scene__,i=r.indexOf(n);reverseEach(r.slice(i,r.push(0)),function(t,e){r[e]=r[e-1]}),r[i]=t}function O(t){return pe[t.tagName.toLowerCase()](t)}function M(t){var e=this.__scene__.indexOf(t);this.__scene__.splice(e,1);for(var n=0;4>n;n++)t.buffer[t.index+n]=0;t.buffer.changed=!0,t.buffer.count-=1}function $(t){return function(n){var r=new t,i=r.buffer;e.__scene__.push(r),r.attr=Object.create(Ae),r.tag=n.tagName.toLowerCase(),r.parentNode=r.parentElement=e;var o=r.indices="line"==t.name?[i.count,i.count+1]:[4*i.count];return o.forEach(function(t){i[t]=i.count+t%2}),i.count+="line"==t.name?2:1,r}}function V(t){be[t]||(d3.select("canvas").on(t,function(){this.__scene__.filter(function(){})}),be[t]=[]),be[t].push(this.id)}function W(t){return q(t),y(t),S(t),F(t),te}function q(){Q.clear(Q.DEPTH_BUFFER_BIT|Q.STENCIL_BUFFER_BIT),Q.clear(Q.COLOR_BUFFER_BIT|Q.DEPTH_BUFFER_BIT|Q.STENCIL_BUFFER_BIT)}function H(){}function j(t,e){if(arguments.length>2)[].forEach.call(arguments,function(e){j(t,e)});else for(var n in e)t[n]=e[n];return t}function z(t,e,n){for(var r=t.length-1,i=0;r>i;)e.call(n,t[i++],t[i++])}function G(){return!1}function K(t,e){for(var n in t)e(t[n],n,t)}function X(t){return this.push(t)}function J(t,e){return new Array(e-t).join(" ").split(" ").map(function(e,n){return n+t})}var Q,Z;if(null==e&&(e=document.body.appendChild(j(document.createElement("canvas"),{height:500,width:960}))),e="string"==typeof e?document.querySelector(e):e instanceof d3.selection?e.node():e,!e)return console.log("invalid selector");if(!e.getContext)return console.log(e,"is not a valid canvas");t.vertexShader=["precision mediump float;","attribute vec4 pos;","attribute float fill;","attribute float stroke;","varying vec4 v_stroke;","varying vec4 v_fill;","varying float v_type;","vec3 unpack_color(float col) {","    if (col == 0.) return vec3(0);","    return vec3(mod(col / 256. / 256., 256.),","                mod(col / 256. , 256.),","                mod(col, 256.)) / 256.; }","void main() {","    gl_Position = vec4(pos.xy, 1., 1.);","    gl_PointSize =  pos.z * 2.;","    v_type = (fill == 0. ? 0. : 1.);","    v_fill = vec4(unpack_color(fill), 1.0);","    v_stroke = vec4(unpack_color(stroke), 1.0);","}"].join("\n"),t.fragmentShader=["precision mediump float;","varying vec4 v_stroke;","varying vec4 v_fill;","varying float v_type;","void main() {","    float dist = distance(gl_PointCoord, vec2(0.5));","    if (dist > 0.5 && v_type == 1.) discard;","    gl_FragColor = v_stroke;","}"].join("\n");var te=!1,ee=new Float32Array(4e4);t.uniforms={mouse:[0,0]},t.stop=function(){te=!0};var ne={m:m,z:E,l:R,h:l,v:h,c:d,s:_,q:v,t:g,a:p};window.pse=b;var re,ie=[0,0],oe=new Uint16Array(4e4),ce=new Float32Array(4e4);oe.count=0,pb=oe,ppb=ce,cb=ee;var ae=new Uint16Array(4e4),ue=new Float32Array(4e4);ae.count=0,lb=ae,lpb=ue;var fe={},se={" ":function(t){return t&&t!==__scene__&&t.parent()},">":function(t,e){return t&&t.parent()==e.parent()&&t.parent()},"~":function(t){return t&&t.previousSibling()},"+":function(t,e,n,r){return!t||(n=C(t))&&(r=C(e))&&n==r&&n}},le=/^(\*|\w+)?(?:([\.\#]+[\w\-\.#]+)?)(\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\])?(:([\w\-]+)(\(['"]?([^()]+)['"]?\))?)?/;d3.scale.linear().domain([0,e.width]).range([-1,1]),d3.scale.linear().domain([0,e.height]).range([1,-1]);var he=function(t){return 2*(t/e.width)-1},de=function(t){return 1-2*(t/e.height)},_e={circle:{r:function(t){ce[this.indices[0]+2]=t},cx:function(t){ce[this.indices[0]+0]=he(t)},cy:function(t){ce[this.indices[0]+1]=de(t)},fill:function(t){var e=d3.rgb(t);ee[this.indices[0]/4]=1+parseInt(e.toString().slice(1),16)},stroke:function(t){return},opacity:function(){},buffer:oe},ellipse:{cx:H,cy:H,rx:H,ry:H},rect:{width:H,height:H,x:H,y:H,rx:ge,ry:ge},image:{"xlink:href":H,height:H,width:H,x:H,y:H},line:{x1:function(t){ue[2*this.indices[0]]=he(t)},y1:function(t){ue[2*this.indices[0]+1]=de(t)},x2:function(t){ue[2*this.indices[1]]=he(t)},y2:function(t){ue[2*this.indices[1]+1]=de(t)},buffer:ae,stroke:function(t){var e=d3.rgb(t);this.indices.forEach(function(t){ee[t]=parseInt(e.toString().slice(1),16)})}},path:{d:U,pathLength:H,buffer:ae,stroke:function(t){var e=d3.rgb(t);this.indices.forEach(function(t){ee[t]=parseInt(e.toString().slice(1),16)})}},polygon:{points:H},polyline:{points:H},g:{appendChild:function(t){this.children.push(O(t))},ctr:function(){this.children=[]}},text:{x:H,y:H,dx:H,dy:H}},ve=j(Object.create(null),{querySelectorAll:x,children:Object.freeze([]),ctr:$,querySelector:function(t){return this.querySelectorAll(t)[0]},createElementNS:H,insertBefore:H,ownerDocument:{createElementNS:H},render:function(){this.buffer&&drawFill(this),drawStroke(this)},previousSibling:function(){e.scene[e.__scene__.indexOf(this)-1]},nextSibling:function(){e.scene[e.__scene__.indexOf()+1]},parent:function(){return __scene__},fill:function(t){G(t)&&initShader(d3.select(t).text(),t)},transform:function(t){var e=d3.transform(t),n=e.rotate*Math.PI/180;e.rotate&&delete e.translate,j(this.attr,e,{rotation:[Math.sin(n),Math.cos(n)]})},stroke:function(t){G(t)&&initShader(d3.select(t).text(),t)},getAttribute:function(t){return this.attr[t]},setAttribute:function(t,e){this.attr[t]=e,this[t]&&this[t](e)},style:{setProperty:H},removeAttribute:function(t){delete this.attr[t]},textContent:H,removeEventListener:H,addEventListener:V}),ge=H,pe=[function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}].reduce(function(t,e){return t[e.name]=$(e),e.prototype=j(Object.create(ve),_e[e.name]),t},{}),Ae={rotation:[0,1],translate:[0,0],scale:[1,1],fill:0,stroke:0,"stroke-width":2,cx:0,cy:0,x:0,y:0,opacity:.999},be={},me=(Date.now(),{});return t.frameCounter=me,n(e)}this.pathgl=t,t.stop=d3.functor()}();