!function(){function t(){}function e(t){return t}function i(t){return[].push.call(this,t)}function n(t){return t&&!(t&t-1)}function r(t){return Math.pow(Math.ceil(Math.sqrt(t)),2)}function o(t,e){for(var i in t)e(t[i],i,t)}function s(){return[-1,-1,1,-1,-1,1,1,1]}function a(t){return t.split(".").pop().join().match(/mp4|ogg|webm/)}function l(){return n(this.height)&&n(this.width)&&(this.data||{}).constructor!==HTMLVideoElement&&this.data}function p(t,e){if(arguments.length>2)[].forEach.call(arguments,function(e){p(t,e)});else for(var i in e)t[i]=e[i];return t}function u(t,e){!t||t.complete||4==t.readyState?e():t.addEventListener&&t.addEventListener("load",e)}function h(t){var e=g(t);return+(255*e[0])<<16^255*e[1]<<8^255*e[2]<<0}function c(t){return t=Math.floor(t),[(255&t>>16)/255,(255&t>>8)/255,(255&t)/255]}function d(t,e,i){if(0===e)return[i,i,i];var n=.5>=i?i*(1+e):i+e-i*e,r=2*i-n;return[f(r,n,t+1/3),f(r,n,t),f(r,n,t-1/3)]}function f(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+6*(e-t)*(2/3-i):t}function g(t){if(be[t])return c(be[t]);if(/^hsl/i.test(t)){var e=t.split(/,|\(/).map(parseFloat);return d(e[1]/360,e[2]/100,e[3]/100)}if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(t)){var i=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(t);return[Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255]}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(t)){var i=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(t);return[Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100]}if(/^\#([0-9a-f]{6})$/i.test(t)){var i=/^\#([0-9a-f]{6})$/i.exec(t);return c(parseInt(i[1],16))}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(t)){var i=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t);return c(parseInt(i[1]+i[1]+i[2]+i[2]+i[3]+i[3],16))}return!1}function y(){function t(){for(var t=-1;++t<l;)h.update()}function e(){}function i(){}function n(){}function r(){return h.mergeProgram(Re,Le),this}function o(){ye.push(t),p.forEach(function(t){t.invalidate()})}function s(t){var e=t().shared("uv","tex1.xy").map("gl_fragcolor = texel(uv);").pipe(p),i=t().sort("float comparator(vec2 a, vec2 b) { return a > b ? a : b }").map("bsearch").pipe(e),n="void main (){float a = texel(uv);float maxC = max(a.r, a.g, a.b)float minC = min(a.r, a.g, a.b)float lightness = (maxC + minC) * .5float  delta = maxC - minCfloat saturation = lightness <= 0.5 ? delta / ( maxC + minC ) : delta / ( 2 - maxC - minC )float hue = maxC == a.r ?  (a.g - a.b ) / delta + ( a.g < a.b ? 6 : 0 ): maxC == a.g  ? ( a.b - a.r ) / delta + 2: ( a.r - a.g ) / delta + 4;hue /= 6gl_FragColor = vec3(hue, saturation, threadIdx.xy);}";return dependencies.map(function(r){var o=t().blocksize(64,64).gridsize(8,8).map(n).reduce(t).pipe(i);r.pipe(o),r[1].pipe(e)}),this}function a(t){return h.drawTo(t),t&&p.push(t),u}var l=2,p=[],u={scatter:e,reduce:n,scan:i,map:r,match:s,pipe:a,invalidate:o},h=M({gl:ve,mesh:v()});return u}function v(){return O(ve,{pos:{array:s(),size:2},attrList:["pos"],count:4,primitive:"triangle_strip"})}function _(t,e,i,n){function r(e,i){var n,r=t.getUniformLocation(_e,e),o="uniform"+w(i)+"fv";_e[e]=function(e){n!=e&&arguments.length&&(t[o](r,Array.isArray(e)?e:[e]),n=e)}}var o=e+"\n"+i;_e=t.createProgram(),_e.shit=Math.random(0);var s=x(t,t.VERTEX_SHADER,e),a=x(t,t.FRAGMENT_SHADER,i);if(t.attachShader(_e,s),t.attachShader(_e,a),t.deleteShader(s),t.deleteShader(a),(n||["pos","color","fugue"]).forEach(function(e,i){t.bindAttribLocation(_e,i,e)}),t.linkProgram(_e),t.useProgram(_e),!t.getProgramParameter(_e,t.LINK_STATUS))throw name+": "+t.getProgramInfoLog(_e);for(var l=/uniform\s+(\S+)\s+(\S+)\s*;/g,p=null;null!=(p=l.exec(o));)r(p[2],p[1]);return _e.merge=E(s,a),_e.gl=t,_e}function m(t,e){o(e||{},function(t,e,i){"cx"==e&&(i.x=t),"cy"==e&&(i.y=t)});var i=p({stroke:"(color.r < 0.) ? vec4(stroke) : unpack_color(stroke)",r:"(pos.z < 0.) ? clamp(texel(pos.xy).w + texel(pos.xy).z, 1., 100.) : (2. * pos.z)",x:"(pos.x < 1.) ? texel(pos.xy).x * resolution.x : pos.x",y:"(pos.y < 1.) ? texel(pos.xy).y * resolution.y : pos.y"},e);for(var n in i)t=t.replace("replace_"+n,i[n]);return t}function x(t,e,i){var n="precision mediump float;\n",r=t.createShader(e);if(t.shaderSource(r,n+i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(r)||"",s=+o.split(":")[2];return console.error((i||"").split("\n").slice(s-5,s+5).join("\n"),o)}return r}function w(t){return t.match("vec")?t[t.length-1]:1}function E(){return function(t,e,i){return e=e||de.fragmentShader,t=m(t,i),_(this.gl,t,e)}}function C(t){if(!(ve=S(canvas=t)))return!!console.log("webGL context could not be initialized");ve.getExtension("OES_texture_float")||console.warn("does not support floating point textures"),_e=_(ve,m(de.vertexShader),de.fragmentShader),canvas.program=_e,A(canvas),T(canvas);var e=M(canvas);return e.drawTo(null),me.push(e.update),ve.clearColor(.3,.3,.3,1),b(ve),I(),me.push(function(){de.uniform("clock",new Date-we)}),canvas}function b(t){t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE),t.blendColor(1,1,1,1)}function T(t){function e(){de.uniform("resolution",[t.width||960,t.height||500])}setInterval(e,100),t.addEventListener("click",F),t.addEventListener("mousemove",q),t.addEventListener("touchmove",P),t.addEventListener("touchstart",P)}function F(){}function q(t){var e=canvas.getBoundingClientRect();de.uniform("mouse",[t.clientX-e.left-canvas.clientLeft,t.clientY-e.top-canvas.clientTop])}function P(t){var e=canvas.getBoundingClientRect();t=t.touches[0],de.uniform("mouse",[t.clientX-e.left-canvas.clientLeft,t.clientY-e.top-canvas.clientTop])}function A(t){window.d3&&p(window.d3.selection.prototype,{vAttr:N,shader:k}),window.d3&&p(window.d3.transition.prototype,{vAttr:N,shader:k}),p(t,Te).gl=ve}function S(t){var e=t.getContext("webgl")||t.getContext("experimental-webgl");return e&&p(e,{viewportWidth:t.width,viewportHeight:t.height})}function N(t,e){return this.each(function(t,i){this.colorBuffer[this.indices[0]]=h(e(t,i))}),this}function k(t){return this.node().mesh.mergeProgram(de.vertexShader,de.fragmentShader,t),this}function I(){for(var t,e=me.length;e--;)me[e]();for(t=ye,ye=[],qe=t;qe.length;)qe.pop()();Fe(I)}function R(t){var e=[],i=[0,0],n=[0,0],r=[];r.push([]),t.match(/[a-z][^a-z]*/gi).forEach(function(t){for(var o=t.slice(1).trim().split(/,| /g),s=t[0].toLowerCase(),a=0;a<o.length;){var l=o[a++],p=o[a++];"m"==s?(r.push(e=[]),n=i=[l,p]):"l"==s?e.push(i[0],i[1],l,p)&&(i=[l,p]):"z"==s?e.push(i[0],i[1],n[0],n[1])&&(i=n):console.log("%d method is not supported malformed path:",s)}}),e=triangulate(r);var o=this.mesh.tessOffset;this.posBuffer.set(e,o),this.indices=e.map(function(t,e){return(o+e)/2}),this.mesh.tessOffset+=e.length}function L(){if(!d3)return console.warn("this method depends on d3");d3.selectAll("link[rel=styleSheet]").each(function(){d3.text});var t=d3.selectAll("style")[0].map(function(){return this.sheet}).reduce(function(t,e){var i={};return o(e.cssRules,function(t){for(var e=t.length,n={};e--;){var r=t[t[e]];n[r]=t[r]}i[t.selectorText]=n}),p(t,i)},{});o(t,function(t,e){d3.select(e).attr(t)})}function O(t,e){function i(){return d+="points"==e.primitive?1:"lines"==e.primitive?2:3}function n(){f.forEach(function(i,n){var r=t.createBuffer(),o=e[i]||{};t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,4e7,t.STREAM_DRAW),c[i]={array:new Float32Array(e[i]&&e[i].array||4e5),buffer:r,size:o.size||4,changed:!0,loc:n}})}function r(t){var e,i;for(i in c)for(i=c,e=i.size;e--;)c[t*i.size+e]=0}function o(t){t.posBuffer=c.pos.array,t.fBuffer=c.fugue.array,t.colorBuffer=c.color.array,t.mesh=this}function s(e){if(d){for(var i in c)i=c[i],t.bindBuffer(t.ARRAY_BUFFER,i.buffer),t.vertexAttribPointer(i.loc,i.size,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.loc),i.changed&&t.bufferSubData(t.ARRAY_BUFFER,0,i.array);t.drawArrays(g,e,1e5)}}function a(){}function l(){}function p(){}function u(){}function h(t,e){~y.indexOf(e)||y.push(e)}var c={},d=e.count||0,f=e.attrList||["pos","color","fugue"],g=t[e.primitive.toUpperCase()],y=[];return n(),{init:n,free:r,tessOffset:0,alloc:i,draw:s,bind:o,bindMaterial:h,attributes:c,set:a,addAttr:l,removeAttr:p,boundingBox:u}}function M(t){function e(e){return e?(l.push(B(e)),t.width=e.width,t.height=e.height,void 0):l.push(null)}function i(t){return(u[t.toLowerCase()]||console.log.bind(console,"oops"))(t)}function n(t,e,i){p=p.merge(t,e,i)}function r(){_e!=p&&a.useProgram(_e=p);for(var e=-1;++e<l.length;){a.bindFramebuffer(a.FRAMEBUFFER,l[e]),o(),s(a,t);for(var i=-1;++i<h.length;)h[i].draw()}}function o(){for(var t in xe)_e[t]&&_e[t](xe[t])}function s(t,e){e==t.canvas&&t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,e.width,e.height)}var a=t.gl,l=[],p=t.program||_e,u=t.types=Q(),h=t.mesh?[t.mesh]:W(a,t.types);return h.forEach(function(t){t.mergeProgram=n}),t.__renderTarget__={update:r,append:i,drawTo:e,mergeProgram:n}}function W(t,e){var i=new O(t,{primitive:"points"});i.bind(e.circle),i.bind(e.rect);var n=new O(t,{primitive:"lines",pos:{size:1}});n.bind(e.line);var r=new O(t,{primitive:"triangles",pos:{size:2}});return r.bind(e.path),[r,i,n]}function B(t){var e=ve.createFramebuffer();return ve.bindFramebuffer(ve.FRAMEBUFFER,e),e.width=t.width,e.height=t.height,ve.framebufferTexture2D(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_2D,t.texture,null),ve.bindFramebuffer(ve.FRAMEBUFFER,null),e}function z(t){return this.querySelectorAll(t)[0]}function D(t,e){return t.replace(/^\s+|\s*([,\s\+\~>]|$)\s*/g,"$1").split(",").forEach(function(t){G(t,this).forEach(i.bind(e=[]))},this)||e}function G(t,e){var i,n=t.split(/[\s\>\+\~](?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),r=t.match(/([\s\>\+\~])(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),o=X(n.pop()),s=[],a=[];return K.call(e,o[1]||"*").forEach(function(t){(i=j.apply(t,o))&&s.push(i)}),n.length?s.forEach(function(t){U(t,n,r)&&a.push(t)})||a:s}function U(t,e,i,n){return n=function r(t,o,s){for(;s=Ae[i[o]](s,t);)if(j.apply(s,X(e[o]))&&o)return(n=r(s,o-1,s))?n:s}(t,e.length-1,t)}function j(t,e,i,n,r,o,s,t,a,t,l,p){return a&&Pe[a]&&!Pe[a](this,l)||e&&"*"!==e&&this.tag&&this.tag.toLowerCase()!==e||n&&!$(o,this.attr[r]||"",s)||i&&(p=i.match(/#([\w\-]+)/))&&p[1]!==this.attr.id||i&&(i.match(/\.[\w\-]+/g)||[]).some(V.bind(this))?0:this}function $(t,e,i){return e.match(RegExp({"=":i,"^=":"^"+Y(i),"$=":Y(i)+"$","*=":Y(i),"~=":"(?:^|\\s+)"+Y(i)+"(?:\\s+|$)","|=":"^"+Y(i)+"(-|$)"}[t]||"adnan^"))}function X(t){return t.match(Se)}function H(t){for(;t=t.previousSibling();)if(t.top)return t}function Y(t){return t.replace(/([.*+?\^=!:${}()|\[\]\/\\])/,"\\$1")}function V(t){return!RegExp("(^|\\s+)"+t.slice(1)+"(\\s+|$)").test(this.attr.class)}function K(t){return J(this,function(e){return"*"==t||e.tagName==t},[])}function J(t,e,i){return(t.__scene__||t.children).forEach(function(t){J(t,e,i),e(t)&&i.push(t)})||i}function Q(){return Ie.reduce(function(t,e){return t[e.name]=function i(){var t=Object.create(e.prototype);return p(t,i),t.init(i.mesh.alloc()-1),t.attr={},t},p(e.prototype,ke,Ne[e.name]),t},{})}function Z(t){R.call(this,t),this.fill(this.attr.stroke)}function te(t,e){var i=canvas.__scene__,n=i.indexOf(e);reverseEach(i.slice(n,i.push(0)),function(t,e){i[e]=i[e-1]}),i[n]=t}function ee(t){return this.__scene__[this.__scene__.length]=this.__renderTarget__.append(t.tagName)}function ie(t){var e=this.__scene__.indexOf(t);t=this.__scene__.splice(e,1)[0],t&&t.mesh.free(e)}function ne(t){this.width=t.width||512,this.height=t.height||512,"string"==typeof t&&(t=oe(t)),"number"==typeof t&&(this.width=this.height=Math.sqrt(t),t=!1),p(this,{gl:ve,id:fe(),data:t,dependents:[],texture:ve.createTexture(),invalidate:function(){ye.push(function(){this.forEach(function(t){t.invalidate()})}.bind(this.dependents))}}),Array.isArray(t)&&(this.data=null,he.call(this,t)),t.constructor==Object&&(t=pe(t)),ue.call(this)}function re(){var t=l.call(this),e=ve[t?"REPEAT":"CLAMP_TO_EDGE"],i=ve[t?"LINEAR":"NEAREST"];ve.bindTexture(ve.TEXTURE_2D,this.texture),ve.pixelStorei(ve.UNPACK_FLIP_Y_WEBGL,!0),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MAG_FILTER,i),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MIN_FILTER,i),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_S,e),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_T,e),this.update()}function oe(t){try{var e=document.querySelector(t);if(e)return e}catch(i){}return p(a?new Image:document.createElement("video"),{crossOrigin:"anonymous",src:t})}function se(t){return this.dependents.push(t),this}function ae(){for(var t=this.size()||0,e=new Array(t);t--;)e[t]={x:this.x()(t,t),y:this.y()(t,t),z:this.z()(t,t)};return e}function le(){p(this,{__scene__:[]})(this.__renderTarget__=M(this)).drawTo(this);var t=this.update;this.update=function(){t.call(this),this.__renderTarget__.update()}}function pe(t){var e=new Float32Array(1024),i=0;for(var n in t){for(var r in t[n])e[i++]=t[n][r];i>1020&&(this.subImage(0,i,e),e=new Float32Array(1024))}}function ue(){var t=this.data;return re.call(this),this.update(Ee),u(t,this.update.bind(this)),this}function he(t){var e=this.height,i=this.height,n=[{x:e,y:i,i:0,size:t.length}],r=this;!function o(t){var i=t.x+t.size,r=i-width;width>i||(t.size-=r,n.push(t={x:0,y:(t.y+1)%e,size:r,i:++t.i}),o(t))}(n[0]),n.forEach(function(e){for(var i=[],n=-1;++n<e.size;)i.push(t[e.i]);r.subImage(e.x,e.y,i)})}function ce(t,e){return Math.random()*(e-t)}var de=this.pathgl={};de.sim={},de.stop=function(){},de.context=function(){return ve};var fe=function(t){return function(){return t++}}(1),ge=0,ye=[];de.texture=function(t){return ge||de.init("canvas"),new ne(t||!1)},de.uniform=function(t,e){return 1==arguments.length?xe[t]:xe[t]=e},de.applyCSS=L,HTMLCanvasElement.prototype.appendChild=function(t){return de.init(this)?this.appendChild(t):void 0};var ve,_e,me=[],xe={},we=Date.now();de.init=function(t){return ge=1,t="string"==typeof t?document.querySelector(t):t instanceof d3.selection?t.node():t,t.getContext?!!C(t):console.log(t,"is not a valid canvas")};var Ee=function(){var t,e,i=document.createElement("canvas").getContext("2d"),n=i.canvas.width=i.canvas.height=128;for(t=0;n>t;t+=16)for(e=0;n>e;e+=16)i.fillStyle=16&(e^t)?"#FFF":"#DDD",i.fillRect(e,t,16,16);return i.canvas}(),Ce=Ce||{};Ce.poly2tri=Ce.poly2tri||{},Ce.poly2tri.fatal=function(t){alert(t)},Ce.poly2tri.Point=function(){this.x=null,this.y=null,0==arguments.length?(this.x=0,this.y=0):2==arguments.length?(this.x=arguments[0],this.y=arguments[1]):Ce.poly2tri.fatal("Invalid js.poly2tri.Point constructor call!"),this.edge_list=[]},Ce.poly2tri.Point.prototype.toString=function(){return"("+this.x+";"+this.y+")"},Ce.poly2tri.Point.prototype.set_zero=function(){this.x=0,this.y=0},Ce.poly2tri.Point.prototype.set=function(t,e){this.x=t,this.y=e},Ce.poly2tri.Point.prototype.negate=function(){this.x=-this.x,this.y=-this.y},Ce.poly2tri.Point.prototype.add=function(t){this.x+=t.x,this.y+=t.y},Ce.poly2tri.Point.prototype.sub=function(t){this.x-=t.x,this.y-=t.y},Ce.poly2tri.Point.prototype.mul=function(t){this.x*=t,this.y*=t},Ce.poly2tri.Point.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Ce.poly2tri.Point.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,t},Ce.poly2tri.Point.prototype.equals=function(t){return Ce.poly2tri.equals(this,t)},Ce.poly2tri.negate=function(t){return new Ce.poly2tri.Point(-t.x,-t.y)},Ce.poly2tri.cmp=function(t,e){return t.y==e.y?t.x-e.x:t.y-e.y},Ce.poly2tri.add=function(t,e){return new Ce.poly2tri.Point(t.x+e.x,t.y+e.y)},Ce.poly2tri.sub=function(t,e){return new Ce.poly2tri.Point(t.x-e.x,t.y-e.y)},Ce.poly2tri.mul=function(t,e){return new Ce.poly2tri.Point(t*e.x,t*e.y)},Ce.poly2tri.equals=function(t,e){return t.x==e.x&&t.y==e.y},Ce.poly2tri.dot=function(t,e){return t.x*e.x+t.y*e.y},Ce.poly2tri.cross=function(){var t=!1,e=!1;return 2==arguments.length?("number"==typeof arguments[0]&&(t=!0),e=!0,t?e?arguments[0].x*arguments[1].y-arguments[0].y*arguments[1].x:new Ce.poly2tri.Point(arguments[1]*arguments[0].y,-arguments[1]*arguments[0].x):e?new Ce.poly2tri.Point(-arguments[0]*arguments[1].y,arguments[0]*arguments[1].x):arguments[0]*arguments[1]):(Ce.poly2tri.fatal("Invalid js.poly2tri.cross call!"),void 0)},Ce.poly2tri.Edge=function(){this.p=null,this.q=null,2==arguments.length?arguments[0].y>arguments[1].y?(this.q=arguments[0],this.p=arguments[1]):arguments[0].y==arguments[1].y?arguments[0].x>arguments[1].x?(this.q=arguments[0],this.p=arguments[1]):arguments[0].x==arguments[1].x?Ce.poly2tri.fatal("Invalid js.poly2tri.edge constructor call: repeated points! "+arguments[0]):(this.p=arguments[0],this.q=arguments[1]):(this.p=arguments[0],this.q=arguments[1]):Ce.poly2tri.fatal("Invalid js.poly2tri.Edge constructor call!"),this.q.edge_list.push(this)},Ce.poly2tri.Triangle=function(t,e,i){this.points_=[null,null,null],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1],3==arguments.length&&(this.points_[0]=t,this.points_[1]=e,this.points_[2]=i)},Ce.poly2tri.Triangle.prototype.toString=function(){return"["+this.points_[0]+this.points_[1]+this.points_[2]+"]"},Ce.poly2tri.Triangle.prototype.GetPoint=function(t){return this.points_[t]},Ce.poly2tri.Triangle.prototype.GetNeighbor=function(t){return this.neighbors_[t]},Ce.poly2tri.Triangle.prototype.ContainsP=function(){for(var t=!0,e=0;e<arguments.length;++e)t=t&&(arguments[e].equals(this.points_[0])||arguments[e].equals(this.points_[1])||arguments[e].equals(this.points_[2]));return t},Ce.poly2tri.Triangle.prototype.ContainsE=function(){for(var t=!0,e=0;e<arguments.length;++e)t=t&&this.ContainsP(arguments[e].p,arguments[e].q);return t},Ce.poly2tri.Triangle.prototype.IsInterior=function(){return 0==arguments.length?this.interior_:(this.interior_=arguments[0],this.interior_)},Ce.poly2tri.Triangle.prototype.MarkNeighbor=function(){var t;if(3==arguments.length){var e=arguments[0],i=arguments[1];t=arguments[2],e.equals(this.points_[2])&&i.equals(this.points_[1])||e.equals(this.points_[1])&&i.equals(this.points_[2])?this.neighbors_[0]=t:e.equals(this.points_[0])&&i.equals(this.points_[2])||e.equals(this.points_[2])&&i.equals(this.points_[0])?this.neighbors_[1]=t:e.equals(this.points_[0])&&i.equals(this.points_[1])||e.equals(this.points_[1])&&i.equals(this.points_[0])?this.neighbors_[2]=t:Ce.poly2tri.fatal("Invalid js.poly2tri.Triangle.MarkNeighbor call (1)!")}else 1==arguments.length?(t=arguments[0],t.ContainsP(this.points_[1],this.points_[2])?(this.neighbors_[0]=t,t.MarkNeighbor(this.points_[1],this.points_[2],this)):t.ContainsP(this.points_[0],this.points_[2])?(this.neighbors_[1]=t,t.MarkNeighbor(this.points_[0],this.points_[2],this)):t.ContainsP(this.points_[0],this.points_[1])&&(this.neighbors_[2]=t,t.MarkNeighbor(this.points_[0],this.points_[1],this))):Ce.poly2tri.fatal("Invalid js.poly2tri.Triangle.MarkNeighbor call! (2)")},Ce.poly2tri.Triangle.prototype.ClearNeigbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},Ce.poly2tri.Triangle.prototype.ClearDelunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},Ce.poly2tri.Triangle.prototype.PointCW=function(t){return t.equals(this.points_[0])?this.points_[2]:t.equals(this.points_[1])?this.points_[0]:t.equals(this.points_[2])?this.points_[1]:null},Ce.poly2tri.Triangle.prototype.PointCCW=function(t){return t.equals(this.points_[0])?this.points_[1]:t.equals(this.points_[1])?this.points_[2]:t.equals(this.points_[2])?this.points_[0]:null},Ce.poly2tri.Triangle.prototype.NeighborCW=function(t){return t.equals(this.points_[0])?this.neighbors_[1]:t.equals(this.points_[1])?this.neighbors_[2]:this.neighbors_[0]},Ce.poly2tri.Triangle.prototype.NeighborCCW=function(t){return t.equals(this.points_[0])?this.neighbors_[2]:t.equals(this.points_[1])?this.neighbors_[0]:this.neighbors_[1]},Ce.poly2tri.Triangle.prototype.GetConstrainedEdgeCW=function(t){return t.equals(this.points_[0])?this.constrained_edge[1]:t.equals(this.points_[1])?this.constrained_edge[2]:this.constrained_edge[0]},Ce.poly2tri.Triangle.prototype.GetConstrainedEdgeCCW=function(t){return t.equals(this.points_[0])?this.constrained_edge[2]:t.equals(this.points_[1])?this.constrained_edge[0]:this.constrained_edge[1]},Ce.poly2tri.Triangle.prototype.SetConstrainedEdgeCW=function(t,e){t.equals(this.points_[0])?this.constrained_edge[1]=e:t.equals(this.points_[1])?this.constrained_edge[2]=e:this.constrained_edge[0]=e},Ce.poly2tri.Triangle.prototype.SetConstrainedEdgeCCW=function(t,e){t.equals(this.points_[0])?this.constrained_edge[2]=e:t.equals(this.points_[1])?this.constrained_edge[0]=e:this.constrained_edge[1]=e},Ce.poly2tri.Triangle.prototype.GetDelaunayEdgeCW=function(t){return t.equals(this.points_[0])?this.delaunay_edge[1]:t.equals(this.points_[1])?this.delaunay_edge[2]:this.delaunay_edge[0]},Ce.poly2tri.Triangle.prototype.GetDelaunayEdgeCCW=function(t){return t.equals(this.points_[0])?this.delaunay_edge[2]:t.equals(this.points_[1])?this.delaunay_edge[0]:this.delaunay_edge[1]},Ce.poly2tri.Triangle.prototype.SetDelaunayEdgeCW=function(t,e){t.equals(this.points_[0])?this.delaunay_edge[1]=e:t.equals(this.points_[1])?this.delaunay_edge[2]=e:this.delaunay_edge[0]=e},Ce.poly2tri.Triangle.prototype.SetDelaunayEdgeCCW=function(t,e){t.equals(this.points_[0])?this.delaunay_edge[2]=e:t.equals(this.points_[1])?this.delaunay_edge[0]=e:this.delaunay_edge[1]=e},Ce.poly2tri.Triangle.prototype.NeighborAcross=function(t){return t.equals(this.points_[0])?this.neighbors_[0]:t.equals(this.points_[1])?this.neighbors_[1]:this.neighbors_[2]},Ce.poly2tri.Triangle.prototype.OppositePoint=function(t,e){var i=t.PointCW(e);return this.PointCW(i)},Ce.poly2tri.Triangle.prototype.Legalize=function(){if(1==arguments.length)this.Legalize(this.points_[0],arguments[0]);else if(2==arguments.length){var t=arguments[0],e=arguments[1];t.equals(this.points_[0])?(this.points_[1]=this.points_[0],this.points_[0]=this.points_[2],this.points_[2]=e):t.equals(this.points_[1])?(this.points_[2]=this.points_[1],this.points_[1]=this.points_[0],this.points_[0]=e):t.equals(this.points_[2])?(this.points_[0]=this.points_[2],this.points_[2]=this.points_[1],this.points_[1]=e):Ce.poly2tri.fatal("Invalid js.poly2tri.Triangle.Legalize call!")}else Ce.poly2tri.fatal("Invalid js.poly2tri.Triangle.Legalize call!")},Ce.poly2tri.Triangle.prototype.Index=function(t){return t.equals(this.points_[0])?0:t.equals(this.points_[1])?1:t.equals(this.points_[2])?2:-1},Ce.poly2tri.Triangle.prototype.EdgeIndex=function(t,e){if(t.equals(this.points_[0])){if(e.equals(this.points_[1]))return 2;if(e.equals(this.points_[2]))return 1}else if(t.equals(this.points_[1])){if(e.equals(this.points_[2]))return 0;if(e.equals(this.points_[0]))return 2}else if(t.equals(this.points_[2])){if(e.equals(this.points_[0]))return 1;if(e.equals(this.points_[1]))return 0}return-1},Ce.poly2tri.Triangle.prototype.MarkConstrainedEdge=function(){if(1==arguments.length)"number"==typeof arguments[0]?this.constrained_edge[arguments[0]]=!0:this.MarkConstrainedEdge(arguments[0].p,arguments[0].q);else if(2==arguments.length){var t=arguments[0],e=arguments[1];e.equals(this.points_[0])&&t.equals(this.points_[1])||e.equals(this.points_[1])&&t.equals(this.points_[0])?this.constrained_edge[2]=!0:e.equals(this.points_[0])&&t.equals(this.points_[2])||e.equals(this.points_[2])&&t.equals(this.points_[0])?this.constrained_edge[1]=!0:(e.equals(this.points_[1])&&t.equals(this.points_[2])||e.equals(this.points_[2])&&t.equals(this.points_[1]))&&(this.constrained_edge[0]=!0)}else Ce.poly2tri.fatal("Invalid js.poly2tri.Triangle.MarkConstrainedEdge call!")},Ce.poly2tri.PI_3div4=3*Math.PI/4,Ce.poly2tri.PI_2=Math.PI/2,Ce.poly2tri.EPSILON=1e-12,Ce.poly2tri.kAlpha=.3,Ce.poly2tri.Orientation={CW:1,CCW:-1,COLLINEAR:0},Ce.poly2tri.Orient2d=function(t,e,i){var n=(t.x-i.x)*(e.y-i.y),r=(t.y-i.y)*(e.x-i.x),o=n-r;return o>-Ce.poly2tri.EPSILON&&o<Ce.poly2tri.EPSILON?Ce.poly2tri.Orientation.COLLINEAR:o>0?Ce.poly2tri.Orientation.CCW:Ce.poly2tri.Orientation.CW},Ce.poly2tri.InScanArea=function(t,e,i,n){var r=n.x,o=n.y,s=t.x-r,a=t.y-o,l=e.x-r,p=e.y-o,u=s*p,h=l*a,c=u-h;if(c<=Ce.poly2tri.EPSILON)return!1;var d=i.x-r,f=i.y-o,g=d*a,y=s*f,v=g-y;return v<=Ce.poly2tri.EPSILON?!1:!0},Ce.poly2tri.Node=function(){this.point=null,this.triangle=null,this.next=null,this.prev=null,this.value=0,1==arguments.length?(this.point=arguments[0],this.value=this.point.x):2==arguments.length?(this.point=arguments[0],this.triangle=arguments[1],this.value=this.point.x):Ce.poly2tri.fatal("Invalid js.poly2tri.Node constructor call!")},Ce.poly2tri.AdvancingFront=function(t,e){this.head_=t,this.tail_=e,this.search_node_=t},Ce.poly2tri.AdvancingFront.prototype.head=function(){return this.head_},Ce.poly2tri.AdvancingFront.prototype.set_head=function(t){this.head_=t},Ce.poly2tri.AdvancingFront.prototype.tail=function(){return this.tail_},Ce.poly2tri.AdvancingFront.prototype.set_tail=function(t){this.tail_=t},Ce.poly2tri.AdvancingFront.prototype.search=function(){return this.search_node_},Ce.poly2tri.AdvancingFront.prototype.set_search=function(t){this.search_node_=t},Ce.poly2tri.AdvancingFront.prototype.FindSearchNode=function(){return this.search_node_},Ce.poly2tri.AdvancingFront.prototype.LocateNode=function(t){var e=this.search_node_;if(t<e.value){for(;null!=(e=e.prev);)if(t>=e.value)return this.search_node_=e,e}else for(;null!=(e=e.next);)if(t<e.value)return this.search_node_=e.prev,e.prev;return null},Ce.poly2tri.AdvancingFront.prototype.LocatePoint=function(t){var e=t.x,i=this.FindSearchNode(e),n=i.point.x;if(e==n){if(i.prev&&t.equals(i.prev.point))i=i.prev;else if(i.next&&t.equals(i.next.point))i=i.next;else if(!t.equals(i.point))return Ce.poly2tri.fatal("Invalid js.poly2tri.AdvancingFront.LocatePoint call!"),null}else if(n>e)for(;null!=(i=i.prev)&&!t.equals(i.point););else for(;null!=(i=i.next)&&!t.equals(i.point););return null!=i&&(this.search_node_=i),i},Ce.poly2tri.Basin=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1},Ce.poly2tri.Basin.prototype.Clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1},Ce.poly2tri.EdgeEvent=function(){this.constrained_edge=null,this.right=!1},Ce.poly2tri.SweepContext=function(t){this.triangles_=[],this.map_=[],this.points_=t,this.edge_list=[],this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new Ce.poly2tri.Basin,this.edge_event=new Ce.poly2tri.EdgeEvent,this.InitEdges(this.points_)},Ce.poly2tri.SweepContext.prototype.AddHole=function(t){this.InitEdges(t);for(var e in t)this.points_.push(t[e])},Ce.poly2tri.SweepContext.prototype.AddPoint=function(t){this.points_.push(t)},Ce.poly2tri.SweepContext.prototype.front=function(){return this.front_},Ce.poly2tri.SweepContext.prototype.point_count=function(){return this.points_.length},Ce.poly2tri.SweepContext.prototype.head=function(){return this.head_},Ce.poly2tri.SweepContext.prototype.set_head=function(t){this.head_=t},Ce.poly2tri.SweepContext.prototype.tail=function(){return this.tail_},Ce.poly2tri.SweepContext.prototype.set_tail=function(t){this.tail_=t},Ce.poly2tri.SweepContext.prototype.GetTriangles=function(){return this.triangles_},Ce.poly2tri.SweepContext.prototype.GetMap=function(){return this.map_},Ce.poly2tri.SweepContext.prototype.InitTriangulation=function(){var t=this.points_[0].x,e=this.points_[0].x,i=this.points_[0].y,n=this.points_[0].y;for(var r in this.points_){var o=this.points_[r];o.x>t&&(t=o.x),o.x<e&&(e=o.x),o.y>i&&(i=o.y),o.y<n&&(n=o.y)}var s=Ce.poly2tri.kAlpha*(t-e),a=Ce.poly2tri.kAlpha*(i-n);this.head_=new Ce.poly2tri.Point(t+s,n-a),this.tail_=new Ce.poly2tri.Point(e-a,n-a),this.points_.sort(Ce.poly2tri.cmp)},Ce.poly2tri.SweepContext.prototype.InitEdges=function(t){for(var e=0;e<t.length;++e)this.edge_list.push(new Ce.poly2tri.Edge(t[e],t[(e+1)%t.length]))},Ce.poly2tri.SweepContext.prototype.GetPoint=function(t){return this.points_[t]},Ce.poly2tri.SweepContext.prototype.AddToMap=function(t){this.map_.push(t)},Ce.poly2tri.SweepContext.prototype.LocateNode=function(t){return this.front_.LocateNode(t.x)},Ce.poly2tri.SweepContext.prototype.CreateAdvancingFront=function(){var t,e,i,n=new Ce.poly2tri.Triangle(this.points_[0],this.tail_,this.head_);this.map_.push(n),t=new Ce.poly2tri.Node(n.GetPoint(1),n),e=new Ce.poly2tri.Node(n.GetPoint(0),n),i=new Ce.poly2tri.Node(n.GetPoint(2)),this.front_=new Ce.poly2tri.AdvancingFront(t,i),t.next=e,e.next=i,e.prev=t,i.prev=e},Ce.poly2tri.SweepContext.prototype.RemoveNode=function(){},Ce.poly2tri.SweepContext.prototype.MapTriangleToNodes=function(t){for(var e=0;3>e;++e)if(null==t.GetNeighbor(e)){var i=this.front_.LocatePoint(t.PointCW(t.GetPoint(e)));null!=i&&(i.triangle=t)}},Ce.poly2tri.SweepContext.prototype.RemoveFromMap=function(t){for(var e in this.map_)if(this.map_[e]==t){delete this.map_[e];break}},Ce.poly2tri.SweepContext.prototype.MeshClean=function(t){for(var e,i,n=[t];e=n.pop();)if(!e.IsInterior())for(e.IsInterior(!0),this.triangles_.push(e),i=0;3>i;i++)e.constrained_edge[i]||n.push(e.GetNeighbor(i))},"function"==typeof Namespace?Namespace("js.poly2tri.sweep"):Ce.poly2tri.sweep=Ce.poly2tri.sweep||{},Ce.poly2tri.sweep.Triangulate=function(t){t.InitTriangulation(),t.CreateAdvancingFront(),Ce.poly2tri.sweep.SweepPoints(t),Ce.poly2tri.sweep.FinalizationPolygon(t)},Ce.poly2tri.sweep.SweepPoints=function(t){for(var e=1;e<t.point_count();++e)for(var i=t.GetPoint(e),n=Ce.poly2tri.sweep.PointEvent(t,i),r=0;r<i.edge_list.length;++r)Ce.poly2tri.sweep.EdgeEvent(t,i.edge_list[r],n)},Ce.poly2tri.sweep.FinalizationPolygon=function(t){for(var e=t.front().head().next.triangle,i=t.front().head().next.point;!e.GetConstrainedEdgeCW(i);)e=e.NeighborCCW(i);t.MeshClean(e)},Ce.poly2tri.sweep.PointEvent=function(t,e){var i=t.LocateNode(e),n=Ce.poly2tri.sweep.NewFrontTriangle(t,e,i);return e.x<=i.point.x+Ce.poly2tri.EPSILON&&Ce.poly2tri.sweep.Fill(t,i),Ce.poly2tri.sweep.FillAdvancingFront(t,n),n},Ce.poly2tri.sweep.EdgeEvent=function(){var t;if(3==arguments.length){t=arguments[0];var e=arguments[1],i=arguments[2];if(t.edge_event.constrained_edge=e,t.edge_event.right=e.p.x>e.q.x,Ce.poly2tri.sweep.IsEdgeSideOfTriangle(i.triangle,e.p,e.q))return;Ce.poly2tri.sweep.FillEdgeEvent(t,e,i),Ce.poly2tri.sweep.EdgeEvent(t,e.p,e.q,i.triangle,e.q)}else if(5==arguments.length){t=arguments[0];var n=arguments[1],r=arguments[2],o=arguments[3],s=arguments[4];if(Ce.poly2tri.sweep.IsEdgeSideOfTriangle(o,n,r))return;var a=o.PointCCW(s),l=Ce.poly2tri.Orient2d(r,a,n);if(l==Ce.poly2tri.Orientation.COLLINEAR)return Ce.poly2tri.fatal("js.poly2tri.sweep.EdgeEvent: Collinear not supported! "+r+a+n),void 0;var p=o.PointCW(s),u=Ce.poly2tri.Orient2d(r,p,n);if(u==Ce.poly2tri.Orientation.COLLINEAR)return Ce.poly2tri.fatal("js.poly2tri.sweep.EdgeEvent: Collinear not supported! "+r+p+n),void 0;l==u?(o=l==Ce.poly2tri.Orientation.CW?o.NeighborCCW(s):o.NeighborCW(s),Ce.poly2tri.sweep.EdgeEvent(t,n,r,o,s)):Ce.poly2tri.sweep.FlipEdgeEvent(t,n,r,o,s)}else Ce.poly2tri.fatal("Invalid js.poly2tri.sweep.EdgeEvent call!")},Ce.poly2tri.sweep.IsEdgeSideOfTriangle=function(t,e,i){var n=t.EdgeIndex(e,i);if(-1!=n){t.MarkConstrainedEdge(n);var r=t.GetNeighbor(n);return null!=r&&r.MarkConstrainedEdge(e,i),!0}return!1},Ce.poly2tri.sweep.NewFrontTriangle=function(t,e,i){var n=new Ce.poly2tri.Triangle(e,i.point,i.next.point);n.MarkNeighbor(i.triangle),t.AddToMap(n);var r=new Ce.poly2tri.Node(e);return r.next=i.next,r.prev=i,i.next.prev=r,i.next=r,Ce.poly2tri.sweep.Legalize(t,n)||t.MapTriangleToNodes(n),r},Ce.poly2tri.sweep.Fill=function(t,e){var i=new Ce.poly2tri.Triangle(e.prev.point,e.point,e.next.point);i.MarkNeighbor(e.prev.triangle),i.MarkNeighbor(e.triangle),t.AddToMap(i),e.prev.next=e.next,e.next.prev=e.prev,Ce.poly2tri.sweep.Legalize(t,i)||t.MapTriangleToNodes(i)
},Ce.poly2tri.sweep.FillAdvancingFront=function(t,e){for(var i,n=e.next;null!=n.next&&(i=Ce.poly2tri.sweep.HoleAngle(n),!(i>Ce.poly2tri.PI_2||i<-Ce.poly2tri.PI_2));)Ce.poly2tri.sweep.Fill(t,n),n=n.next;for(n=e.prev;null!=n.prev&&(i=Ce.poly2tri.sweep.HoleAngle(n),!(i>Ce.poly2tri.PI_2||i<-Ce.poly2tri.PI_2));)Ce.poly2tri.sweep.Fill(t,n),n=n.prev;null!=e.next&&null!=e.next.next&&(i=Ce.poly2tri.sweep.BasinAngle(e),i<Ce.poly2tri.PI_3div4&&Ce.poly2tri.sweep.FillBasin(t,e))},Ce.poly2tri.sweep.BasinAngle=function(t){var e=t.point.x-t.next.next.point.x,i=t.point.y-t.next.next.point.y;return Math.atan2(i,e)},Ce.poly2tri.sweep.HoleAngle=function(t){var e=t.next.point.x-t.point.x,i=t.next.point.y-t.point.y,n=t.prev.point.x-t.point.x,r=t.prev.point.y-t.point.y;return Math.atan2(e*r-i*n,e*n+i*r)},Ce.poly2tri.sweep.Legalize=function(t,e){for(var i=0;3>i;++i)if(!e.delaunay_edge[i]){var n=e.GetNeighbor(i);if(null!=n){var r=e.GetPoint(i),o=n.OppositePoint(e,r),s=n.Index(o);if(n.constrained_edge[s]||n.delaunay_edge[s]){e.constrained_edge[i]=n.constrained_edge[s];continue}var a=Ce.poly2tri.sweep.Incircle(r,e.PointCCW(r),e.PointCW(r),o);if(a){e.delaunay_edge[i]=!0,n.delaunay_edge[s]=!0,Ce.poly2tri.sweep.RotateTrianglePair(e,r,n,o);var l=!Ce.poly2tri.sweep.Legalize(t,e);return l&&t.MapTriangleToNodes(e),l=!Ce.poly2tri.sweep.Legalize(t,n),l&&t.MapTriangleToNodes(n),e.delaunay_edge[i]=!1,n.delaunay_edge[s]=!1,!0}}}return!1},Ce.poly2tri.sweep.Incircle=function(t,e,i,n){var r=t.x-n.x,o=t.y-n.y,s=e.x-n.x,a=e.y-n.y,l=r*a,p=s*o,u=l-p;if(0>=u)return!1;var h=i.x-n.x,c=i.y-n.y,d=h*o,f=r*c,g=d-f;if(0>=g)return!1;var y=s*c,v=h*a,_=r*r+o*o,m=s*s+a*a,x=h*h+c*c,w=_*(y-v)+m*g+x*u;return w>0},Ce.poly2tri.sweep.RotateTrianglePair=function(t,e,i,n){var r,o,s,a;r=t.NeighborCCW(e),o=t.NeighborCW(e),s=i.NeighborCCW(n),a=i.NeighborCW(n);var l,p,u,h;l=t.GetConstrainedEdgeCCW(e),p=t.GetConstrainedEdgeCW(e),u=i.GetConstrainedEdgeCCW(n),h=i.GetConstrainedEdgeCW(n);var c,d,f,g;c=t.GetDelaunayEdgeCCW(e),d=t.GetDelaunayEdgeCW(e),f=i.GetDelaunayEdgeCCW(n),g=i.GetDelaunayEdgeCW(n),t.Legalize(e,n),i.Legalize(n,e),i.SetDelaunayEdgeCCW(e,c),t.SetDelaunayEdgeCW(e,d),t.SetDelaunayEdgeCCW(n,f),i.SetDelaunayEdgeCW(n,g),i.SetConstrainedEdgeCCW(e,l),t.SetConstrainedEdgeCW(e,p),t.SetConstrainedEdgeCCW(n,u),i.SetConstrainedEdgeCW(n,h),t.ClearNeigbors(),i.ClearNeigbors(),r&&i.MarkNeighbor(r),o&&t.MarkNeighbor(o),s&&t.MarkNeighbor(s),a&&i.MarkNeighbor(a),t.MarkNeighbor(i)},Ce.poly2tri.sweep.FillBasin=function(t,e){for(t.basin.left_node=Ce.poly2tri.Orient2d(e.point,e.next.point,e.next.next.point)==Ce.poly2tri.Orientation.CCW?e.next.next:e.next,t.basin.bottom_node=t.basin.left_node;null!=t.basin.bottom_node.next&&t.basin.bottom_node.point.y>=t.basin.bottom_node.next.point.y;)t.basin.bottom_node=t.basin.bottom_node.next;if(t.basin.bottom_node!=t.basin.left_node){for(t.basin.right_node=t.basin.bottom_node;null!=t.basin.right_node.next&&t.basin.right_node.point.y<t.basin.right_node.next.point.y;)t.basin.right_node=t.basin.right_node.next;t.basin.right_node!=t.basin.bottom_node&&(t.basin.width=t.basin.right_node.point.x-t.basin.left_node.point.x,t.basin.left_highest=t.basin.left_node.point.y>t.basin.right_node.point.y,Ce.poly2tri.sweep.FillBasinReq(t,t.basin.bottom_node))}},Ce.poly2tri.sweep.FillBasinReq=function(t,e){if(!Ce.poly2tri.sweep.IsShallow(t,e)){Ce.poly2tri.sweep.Fill(t,e);var i;if(e.prev!=t.basin.left_node||e.next!=t.basin.right_node){if(e.prev==t.basin.left_node){if(i=Ce.poly2tri.Orient2d(e.point,e.next.point,e.next.next.point),i==Ce.poly2tri.Orientation.CW)return;e=e.next}else if(e.next==t.basin.right_node){if(i=Ce.poly2tri.Orient2d(e.point,e.prev.point,e.prev.prev.point),i==Ce.poly2tri.Orientation.CCW)return;e=e.prev}else e=e.prev.point.y<e.next.point.y?e.prev:e.next;Ce.poly2tri.sweep.FillBasinReq(t,e)}}},Ce.poly2tri.sweep.IsShallow=function(t,e){var i;return i=t.basin.left_highest?t.basin.left_node.point.y-e.point.y:t.basin.right_node.point.y-e.point.y,t.basin.width>i?!0:!1},Ce.poly2tri.sweep.FillEdgeEvent=function(t,e,i){t.edge_event.right?Ce.poly2tri.sweep.FillRightAboveEdgeEvent(t,e,i):Ce.poly2tri.sweep.FillLeftAboveEdgeEvent(t,e,i)},Ce.poly2tri.sweep.FillRightAboveEdgeEvent=function(t,e,i){for(;i.next.point.x<e.p.x;)Ce.poly2tri.Orient2d(e.q,i.next.point,e.p)==Ce.poly2tri.Orientation.CCW?Ce.poly2tri.sweep.FillRightBelowEdgeEvent(t,e,i):i=i.next},Ce.poly2tri.sweep.FillRightBelowEdgeEvent=function(t,e,i){i.point.x<e.p.x&&(Ce.poly2tri.Orient2d(i.point,i.next.point,i.next.next.point)==Ce.poly2tri.Orientation.CCW?Ce.poly2tri.sweep.FillRightConcaveEdgeEvent(t,e,i):(Ce.poly2tri.sweep.FillRightConvexEdgeEvent(t,e,i),Ce.poly2tri.sweep.FillRightBelowEdgeEvent(t,e,i)))},Ce.poly2tri.sweep.FillRightConcaveEdgeEvent=function(t,e,i){Ce.poly2tri.sweep.Fill(t,i.next),i.next.point!=e.p&&Ce.poly2tri.Orient2d(e.q,i.next.point,e.p)==Ce.poly2tri.Orientation.CCW&&Ce.poly2tri.Orient2d(i.point,i.next.point,i.next.next.point)==Ce.poly2tri.Orientation.CCW&&Ce.poly2tri.sweep.FillRightConcaveEdgeEvent(t,e,i)},Ce.poly2tri.sweep.FillRightConvexEdgeEvent=function(t,e,i){Ce.poly2tri.Orient2d(i.next.point,i.next.next.point,i.next.next.next.point)==Ce.poly2tri.Orientation.CCW?Ce.poly2tri.sweep.FillRightConcaveEdgeEvent(t,e,i.next):Ce.poly2tri.Orient2d(e.q,i.next.next.point,e.p)==Ce.poly2tri.Orientation.CCW&&Ce.poly2tri.sweep.FillRightConvexEdgeEvent(t,e,i.next)},Ce.poly2tri.sweep.FillLeftAboveEdgeEvent=function(t,e,i){for(;i.prev.point.x>e.p.x;)Ce.poly2tri.Orient2d(e.q,i.prev.point,e.p)==Ce.poly2tri.Orientation.CW?Ce.poly2tri.sweep.FillLeftBelowEdgeEvent(t,e,i):i=i.prev},Ce.poly2tri.sweep.FillLeftBelowEdgeEvent=function(t,e,i){i.point.x>e.p.x&&(Ce.poly2tri.Orient2d(i.point,i.prev.point,i.prev.prev.point)==Ce.poly2tri.Orientation.CW?Ce.poly2tri.sweep.FillLeftConcaveEdgeEvent(t,e,i):(Ce.poly2tri.sweep.FillLeftConvexEdgeEvent(t,e,i),Ce.poly2tri.sweep.FillLeftBelowEdgeEvent(t,e,i)))},Ce.poly2tri.sweep.FillLeftConvexEdgeEvent=function(t,e,i){Ce.poly2tri.Orient2d(i.prev.point,i.prev.prev.point,i.prev.prev.prev.point)==Ce.poly2tri.Orientation.CW?Ce.poly2tri.sweep.FillLeftConcaveEdgeEvent(t,e,i.prev):Ce.poly2tri.Orient2d(e.q,i.prev.prev.point,e.p)==Ce.poly2tri.Orientation.CW&&Ce.poly2tri.sweep.FillLeftConvexEdgeEvent(t,e,i.prev)},Ce.poly2tri.sweep.FillLeftConcaveEdgeEvent=function(t,e,i){Ce.poly2tri.sweep.Fill(t,i.prev),i.prev.point!=e.p&&Ce.poly2tri.Orient2d(e.q,i.prev.point,e.p)==Ce.poly2tri.Orientation.CW&&Ce.poly2tri.Orient2d(i.point,i.prev.point,i.prev.prev.point)==Ce.poly2tri.Orientation.CW&&Ce.poly2tri.sweep.FillLeftConcaveEdgeEvent(t,e,i)},Ce.poly2tri.sweep.FlipEdgeEvent=function(t,e,i,n,r){var o=n.NeighborAcross(r);if(null==o)return Ce.poly2tri.fatal("[BUG:FIXME] FLIP failed due to missing triangle!"),void 0;var s=o.OppositePoint(n,r);if(Ce.poly2tri.InScanArea(r,n.PointCCW(r),n.PointCW(r),s))if(Ce.poly2tri.sweep.RotateTrianglePair(n,r,o,s),t.MapTriangleToNodes(n),t.MapTriangleToNodes(o),r==i&&s==e)i==t.edge_event.constrained_edge.q&&e==t.edge_event.constrained_edge.p&&(n.MarkConstrainedEdge(e,i),o.MarkConstrainedEdge(e,i),Ce.poly2tri.sweep.Legalize(t,n),Ce.poly2tri.sweep.Legalize(t,o));else{var a=Ce.poly2tri.Orient2d(i,s,e);n=Ce.poly2tri.sweep.NextFlipTriangle(t,a,n,o,r,s),Ce.poly2tri.sweep.FlipEdgeEvent(t,e,i,n,r)}else{var l=Ce.poly2tri.sweep.NextFlipPoint(e,i,o,s);Ce.poly2tri.sweep.FlipScanEdgeEvent(t,e,i,n,o,l),Ce.poly2tri.sweep.EdgeEvent(t,e,i,n,r)}},Ce.poly2tri.sweep.NextFlipTriangle=function(t,e,i,n,r,o){var s;return e==Ce.poly2tri.Orientation.CCW?(s=n.EdgeIndex(r,o),n.delaunay_edge[s]=!0,Ce.poly2tri.sweep.Legalize(t,n),n.ClearDelunayEdges(),i):(s=i.EdgeIndex(r,o),i.delaunay_edge[s]=!0,Ce.poly2tri.sweep.Legalize(t,i),i.ClearDelunayEdges(),n)},Ce.poly2tri.sweep.NextFlipPoint=function(t,e,i,n){var r=Ce.poly2tri.Orient2d(e,n,t);return r==Ce.poly2tri.Orientation.CW?i.PointCCW(n):r==Ce.poly2tri.Orientation.CCW?i.PointCW(n):(Ce.poly2tri.fatal("[Unsupported] js.poly2tri.sweep.NextFlipPoint: opposing point on constrained edge!"),void 0)},Ce.poly2tri.sweep.FlipScanEdgeEvent=function(t,e,i,n,r,o){var s=r.NeighborAcross(o);if(null==s)return Ce.poly2tri.fatal("[BUG:FIXME] FLIP failed due to missing triangle"),void 0;var a=s.OppositePoint(r,o);if(Ce.poly2tri.InScanArea(i,n.PointCCW(i),n.PointCW(i),a))Ce.poly2tri.sweep.FlipEdgeEvent(t,i,a,s,a);else{var l=Ce.poly2tri.sweep.NextFlipPoint(e,i,s,a);Ce.poly2tri.sweep.FlipScanEdgeEvent(t,e,i,n,s,l)}};var be={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};de.shader=y,de.vertexShader=["uniform float clock;","uniform vec2 mouse;","uniform vec2 resolution;","uniform vec2 dates;","attribute vec4 pos;","attribute vec4 color;","attribute vec4 fugue;","varying float type;","varying vec4 v_stroke;","varying vec4 v_fill;","varying vec4 dim;","uniform sampler2D texture0;","uniform sampler2D texture1;","uniform sampler2D texture2;","uniform sampler2D texture3;","const mat4 modelViewMatrix = mat4(1.);","const mat4 projectionMatrix = mat4(1.);","vec4 unpack_tex(float col) {","    return vec4(mod(col / 1000. / 1000., 1000.),","                mod(col / 1000. , 1000.),","                mod(col, 1000.),","                col);","}","vec4 texel(vec2 get) { return texture2D(texture0, abs(get)); }","vec4 unpack_color(float col) {","    return vec4(mod(col / 256. / 256., 256.),","                mod(col / 256. , 256.),","                mod(col, 256.),","                256. - fugue.y)","                / 256.;","}","vec2 clipspace(vec2 pos) { return vec2(2. * (pos.x / resolution.x) - 1., 1. - ((pos.y / resolution.y) * 2.)); }","void main() {","    float time = clock / 1000.;","    float x = replace_x;","    float y = replace_y;","    float r = replace_r;","    float fill = color.x;","    float stroke = color.x;","    type = fugue.x;","    gl_PointSize =  r;","    v_fill = unpack_color(fill);","    dim = vec4(x, y, r, -r);","    v_stroke = replace_stroke;","    gl_Position = vec4(clipspace(vec2(x, y)),  1., 1.);","}"].join("\n\n"),de.fragmentShader=["uniform sampler2D texture0;","uniform vec2 resolution;","uniform vec2 dates;","varying float type;","varying vec4 v_stroke;","varying vec4 v_fill;","varying vec4 dim;","vec2 clipspace(vec2 pos) { return vec2(2. * (pos.x / resolution.x) - .5, 1. - ((pos.y / resolution.y))); }","void main() {","    float dist = distance(gl_PointCoord, vec2(0.5));","    if (type == 1. && dist > 0.5) discard;","    gl_FragColor = (v_stroke.x < 0.) ? texture2D(texture0, clipspace(dim.xy + (dim.zw * (gl_PointCoord - .5)))) : v_stroke;","}"].join("\n");var Te={appendChild:ee,querySelectorAll:D,querySelector:function(t){return this.querySelectorAll(t)[0]},removeChild:ie,insertBefore:te,__scene__:[],__program__:void 0},Fe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},qe=[];window.parsePath=R;var Pe={},Ae={" ":function(t){return t&&t!==__scene__&&t.parent()},">":function(t,e){return t&&t.parent()==e.parent()&&t.parent()},"~":function(t){return t&&t.previousSibling()},"+":function(t,e,i,n){return!t||(i=H(t))&&(n=H(e))&&i==n&&i}},Se=/^(\*|\w+)?(?:([\.\#]+[\w\-\.#]+)?)(\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\])?(:([\w\-]+)(\(['"]?([^()]+)['"]?\))?)?/,Ne={circle:{init:function(t){this.fBuffer[4*t]=1,this.indices=[4*t]},cx:function(t){this.posBuffer[this.indices[0]+0]=t},cy:function(t){this.posBuffer[this.indices[0]+1]=t},r:function(t){this.posBuffer[this.indices[0]+2]=t},cz:function(t){this.posBuffer[this.indices[0]+3]=t},fill:function(t){this.colorBuffer[this.indices[0]]=0>t?t:h(t)},stroke:function(t){this.colorBuffer[this.indices[0]]=h(t)},tagName:"circle",schema:"cx cy r cz".split(" ")},ellipse:{init:function(){},tagName:"ellipse",cx:t,cy:t,rx:t,ry:t},rect:{init:function(t){this.fBuffer[4*t]=0,this.indices=[4*t]},tagName:"rect",fill:function(t){this.colorBuffer[this.indices[0]]=0>t?t:h(t)},x:function(t){this.posBuffer[this.indices[0]+0]=t},y:function(t){this.posBuffer[this.indices[0]+1]=t},width:function(t){this.posBuffer[this.indices[0]+2]=t},height:function(t){this.posBuffer[this.indices[0]+3]=t},rx:t,ry:t},image:{init:function(){},tagName:"image","xlink:href":t,height:t,width:t,x:t,y:t},line:{init:function(t){this.indices=[2*t,2*t+1]},tagName:"line",x1:function(t){this.posBuffer[2*this.indices[0]]=t},y1:function(t){this.posBuffer[2*this.indices[0]+1]=t},x2:function(t){this.posBuffer[2*this.indices[1]]=t},y2:function(t){this.posBuffer[2*this.indices[1]+1]=t},stroke:function(t){var e=h(t);this.indices.forEach(function(t){this.colorBuffer[4*t]=e},this)}},path:{init:function(){this.indices=[]},tagName:"path",d:Z,pathLength:t,fill:function(t){var e=h(t);this.indices.forEach(function(t){this.colorBuffer[4*t]=e},this)}},polygon:{init:function(){},tagName:"polygon",points:t},polyline:{init:function(t){this.indices=[2*t,2*t+1]},tagName:"polyline",points:t},g:{init:function(){},tagName:"g",appendChild:function(t){this.children.push(ee(t))},ctr:function(){this.children=[]}},text:{init:function(){},tagName:"text",x:t,y:t,dx:t,dy:t}},ke={gl:ve,children:Object.freeze([]),querySelector:z,querySelectorAll:D,createElementNS:e,insertBefore:t,ownerDocument:{createElementNS:function(t,e){return e}},previousSibling:function(){canvas.scene[canvas.__scene__.indexOf(this)-1]},nextSibling:function(){canvas.scene[canvas.__scene__.indexOf()+1]},parent:function(){return __scene__},opacity:function(t){this.fBuffer[this.indices[0]+1]=256-256*t},transform:function(){},getAttribute:function(t){return this.attr[t]},setAttribute:function(t,e){this.attr[t]=e,this[t]&&this[t](e),e&&e.texture&&this.mesh.bindMaterial(t,e)},removeAttribute:function(t){delete this.attr[t]},textContent:t,removeEventListener:t,addEventListener:addEventListener,style:{setProperty:t},ownerSVGElement:{createSVGPoint:t}},Ie=[function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}];ne.prototype={update:function(t){this.data?ve.texImage2D(ve.TEXTURE_2D,0,ve.RGBA,ve.RGBA,ve.UNSIGNED_BYTE,t||this.data):ve.texImage2D(ve.TEXTURE_2D,0,ve.RGBA,this.width,this.height,0,ve.RGBA,ve.FLOAT,null)},size:function(t,e){return arguments.length?(this.width=t,this.height=e||t,this):this.width*this.height},z:function(){var t=Math.sqrt(this.size());return function(e,i){return-1/t*~~(i%t)}},x:function(){var t=Math.sqrt(this.size());return function(e,i){return-1/t*~~(i%t)}},y:function(){var t=Math.sqrt(this.size());return function(e,i){return-1/t*~~(i/t)}},subImage:function(t,e,i){ve.bindTexture(ve.TEXTURE_2D,this.texture),ve.texSubImage2D(ve.TEXTURE_2D,0,t,e,i.length/4,1,ve.RGBA,ve.FLOAT,new Float32Array(i))},repeat:function(){return this.task=function(){this.update()}.bind(this),me.push(this.task),this},stop:function(){this.task&&me.splice(me.indexOf(this.task)),delete this.task},appendChild:function(t){return this.__renderTarget__||le.call(this),this.__scene__[this.__scene__.length]=this.__renderTarget__.append(t.tagName||t)},valueOf:function(){return-this.id},copy:function(){return de.texture(this.src)},pipe:se,querySelector:z,querySelectorAll:D,ownerDocument:{createElementNS:function(t,e){return e}},unwrap:ae,adnan:!0};var Re=["attribute vec2 pos;","  void main() {","  gl_Position = vec4(pos.xy, 1.0 , 1.0);","  }"].join("\n"),Le=["uniform sampler2D texture;","uniform vec2 resolution;","uniform vec2 mouse;","uniform vec2 dimensions;","uniform float gravity;","uniform float inertia;","uniform float drag;","uniform float clock;","void main() {","vec2 TARGET = vec2(mouse / resolution);","vec4 data = texture2D(texture, (gl_FragCoord.xy) / dimensions);","vec2 pos = data.xy;","vec2 vel = data.zw;","if (pos.x > 1.) { vel.x *= -1.; pos.x = 1.; } ","if (pos.y > 1.) { vel.y *= -1.; pos.y = 1.; } ","if (pos.x < 0.) { vel.x *= -1.; pos.x = 0.; } ","if (pos.y < 0.) { vel.y *= -1.; pos.y = 0.; } ","pos += inertia  * vel;","vel += gravity * normalize(TARGET - pos);","vel *= drag;","gl_FragColor = vec4(pos, vel);","}"].join("\n");Date.now(),de.sim.particles=function(t){function e(){de.uniform("gravity",-1*de.uniform("gravity"))}function i(){de.uniform("dimensions",[a,l]),de.uniform("gravity",.1),de.uniform("inertia",.005),de.uniform("drag",.991);for(var t=-1;++t<10;)o(s/10,[1,2].map(Math.random))}function n(t,e){o(e||s*Math.random(),t||[0,0])}function o(t,e){var i=~~(u%a),n=~~(u/l),r=[{x:i,y:n,size:t}];!function o(t){var e=t.x+t.size,i=e-a;a>e||(t.size-=i,r.push(t={x:0,y:(t.y+1)%l,size:i}),o(t))}(r[0]),r.forEach(function(t){for(var i=[],n=-1;++n<t.size;)i.push(e[0],e[1],ce(-1,1),ce(-1,1));h.subImage(t.x,t.y,i)}),u+=t,u%=s}var s=r(t),a=Math.sqrt(s),l=a,u=0,h=de.texture(s),c=de.shader().map(Le);return h.pipe(c),c.pipe(h),c.invalidate(),setTimeout(i,1e3),p(h,{emit:n,reverse:e})}}();