!function(){function e(n){function r(e){var t=c(e);return+(255*t[0])<<16^255*t[1]<<8^255*t[2]<<0}function i(e){return e=Math.floor(e),[(255&e>>16)/255,(255&e>>8)/255,(255&e)/255]}function o(e,t,n){if(0===t)return[n,n,n];var r=.5>=n?n*(1+t):n+t-n*t,i=2*n-r;return[a(i,r,e+1/3),a(i,r,e),a(i,r,e-1/3)]}function a(e,t,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?e+6*(t-e)*n:.5>n?t:2/3>n?e+6*(t-e)*(2/3-n):e}function c(e){if(ot[e])return i(ot[e]);if(/^hsl/i.test(e)){var t=e.split(/,|\(/).map(parseFloat);return o(t[1]/360,t[2]/100,t[3]/100)}if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var n=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);return[Math.min(255,parseInt(n[1],10))/255,Math.min(255,parseInt(n[2],10))/255,Math.min(255,parseInt(n[3],10))/255]}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)){var n=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);return[Math.min(100,parseInt(n[1],10))/100,Math.min(100,parseInt(n[2],10))/100,Math.min(100,parseInt(n[3],10))/100]}if(/^\#([0-9a-f]{6})$/i.test(e)){var n=/^\#([0-9a-f]{6})$/i.exec(e);return i(parseInt(n[1],16))}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var n=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return i(parseInt(n[1]+n[1]+n[2]+n[2]+n[3]+n[3],16))}}function u(e,t,n,r){if(it=e.createProgram(),t=f(e,e.VERTEX_SHADER,t),n=f(e,e.FRAGMENT_SHADER,n),e.attachShader(it,t),e.attachShader(it,n),e.deleteShader(t),e.deleteShader(n),(r||"pos color fugue".split(" ")).forEach(function(t,n){e.bindAttribLocation(it,n,t)}),e.linkProgram(it),e.useProgram(it),!e.getProgramParameter(it,e.LINK_STATUS))throw name+": "+e.getProgramInfoLog(it);return K({type:[0],mouse:[0,0],dates:[0,0],resolution:[0,0],clock:[0]},h.bind(it)),it}function s(t){var n=e.vertexShader;K(t||{},function(e,t,n){"cx"==t&&(n.x=e),"cy"==t&&(n.y=e)});var r=Z({stroke:"(color.r < 0.) ? vec4(stroke) : unpack_color(stroke)",r:"2. * pos.z",x:"pos.x",y:"pos.y"},t);for(var i in r)n=n.replace("replace_"+i,r[i]);return n}function l(t,n){return u(t,s(n),e.fragmentShader)}function f(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r)||"",o=+i.split(":")[2];return console.error((n||"").split("\n").slice(o-5,o+5).join("\n"),i)}return r}function h(e,t){var n,r=rt.getUniformLocation(it,t);(it[t]=function(t){if(n!=t){if(null==t)return n;rt["uniform"+e.length+"fv"](r,Array.isArray(t)?t:[t]),n=t}})(e)}function d(e){if(!(rt=y(n=e)))return!!console.log("webGL context could not be initialized");it=l(rt),n.program=it,_(n),p(n);var t=k(n);return Et.push(t.update),rt.clearColor(0,0,0,0),Y(),n}function p(t){setInterval(function(){e.uniform("resolution",[t.width,t.height])},50),t.addEventListener("click",g),t.addEventListener("mousemove",m),t.addEventListener("touchmove",v),t.addEventListener("touchstart",v)}function g(){}function m(t){var r=n.getBoundingClientRect();e.uniform("mouse",[t.clientX-r.left-n.clientLeft,t.clientY-r.top-n.clientTop])}function v(t){var r=n.getBoundingClientRect();t=t.touches[0],e.uniform("mouse",[t.clientX-r.left-n.clientLeft,t.clientY-r.top-n.clientTop])}function _(e){window.d3&&Z(window.d3.selection.prototype,{pAttr:b,shader:E}),Z(e,ct).gl=rt}function y(e){var t=e.getContext("webgl")||e.getContext("experimental-webgl");return t&&Z(t,{viewportWidth:e.width,viewportHeight:e.height})}function b(e){return this.each(function(t){for(var n in e)this.posBuffer[this.indices[0]+this.schema.indexOf(n)]=e[n](t)}),ht=!0,this}function E(e,t){if(2==arguments.length){var n={};n[e]=t}return l(this.node().parentNode.gl,n||e),this}function w(e){var t=[],n=this.buffer,r=this.posBuffer,i=this.indices,o=[0,0],a=i.length,c=0,u=[0,0];for(e.match(/[a-z][^a-z]*/gi).forEach(function(e){for(var n=e.slice(1).trim().split(/,| /g),r=e[0].toLowerCase(),i=0;i<n.length;){var a=n[i++],c=n[i++];"m"==r?u=o=[a,c]:"l"==r?t.push(o[0],o[1],a,c)&&(o=[a,c]):"z"==r?t.push(o[0],o[1],u[0],u[1])&&(o=u):console.log("%d method is not supported malformed path:",r)}});i.length<t.length;)i.push(n.count+c++);i.length>t.length&&(i.length=t.length),i.forEach(function(e,i){r[3*n[e]+e%3]=i<t.length&&t[i]}),n.count+=t.length-a}function x(){var e=d3.selectAll("style")[0].map(function(){return this.sheet}).reduce(function(e,t){var n={};return K(t.cssRules,function(e){for(var t=e.length,r={};t--;){var i=e[e[t]];r[i]=e[i]}n[e.selectorText]=r}),Z(e,n)},{});K(e,function(e,t){d3.select(t).attr(e)})}function A(e,t,n){function r(){d+=1}function i(){p.forEach(function(r,i){var o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,4e7,e.STREAM_DRAW);var a="pos"==r&&t==e.LINES?2:4;h[r]={array:Z(new Float32Array(4e5),n),buffer:o,size:a,changed:!0,loc:i}})}function o(e){var t,n;for(n in h)for(n=h,t=n.size;t--;)h[e*n.size+t]=0}function a(e){e.posBuffer=h.pos.array,e.fBuffer=h.fugue.array,e.colorBuffer=h.color.array,e.mesh=this}function c(n){if(d){for(var r in h)r=h[r],e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.vertexAttribPointer(r.loc,r.size,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r.loc),r.changed&&e.bufferSubData(e.ARRAY_BUFFER,0,r.array);e.drawArrays(t,n||0,d)}}function u(){}function s(){}function l(){}function f(){}var h={},d=0,p=["pos","color","fugue"];return t=e[t.toUpperCase()],i(),{init:i,free:o,plus1:r,draw:c,bind:a,attributes:h,set:u,addAttr:s,removeAttr:l,boundingBox:f}}function k(t){function n(){for(it!=s&&o.useProgram(it=s),o.bindFramebuffer(o.FRAMEBUFFER,u),r(),i(o),e.uniform("clock",new Date-bt),c=-1;++c<a.length;)a[c].draw()}function r(){(xt[u]||[]).length&&l&&(o.bindTexture(o.TEXTURE_2D,xt[u][0].data),l=!0)}function i(e){u||e.clear(e.COLOR_BUFFER_BIT),e.viewport(0,0,t.width,t.height)}t.types=$();var o=t.gl,a=R(o,t.types),c=0,u=t.fbo||null,s=t.program,l=!1;return t.mesh&&a.push(t.mesh),u&&T.call(t),{update:n}}function R(e,t){var n=new A(e,"points");n.bind(t.circle),n.bind(t.rect);var r=new A(e,"lines");return r.bind(t.line),[n,r]}function T(){var e=512,t=512;this.update(),rt.bindFramebuffer(rt.FRAMEBUFFER,this.fbo),this.fbo.width=e,this.fbo.height=t,rt.framebufferTexture2D(rt.FRAMEBUFFER,rt.COLOR_ATTACHMENT0,rt.TEXTURE_2D,this.data,0),console.log(rt.checkFramebufferStatus(rt.FRAMEBUFFER)),rt.bindFramebuffer(rt.FRAMEBUFFER,null)}function B(e,t){return e.replace(/^\s+|\s*([,\s\+\~>]|$)\s*/g,"$1").split(",").forEach(function(e){S(e,this).forEach(V.bind(t=[]))},this)||t}function S(e,t){var n,r=e.split(/[\s\>\+\~](?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),i=e.match(/([\s\>\+\~])(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),o=D(r.pop()),a=[],c=[];return O.call(t,o[1]||"*").forEach(function(e){(n=C.apply(e,o))&&a.push(n)}),r.length?a.forEach(function(e){F(e,r,i)&&c.push(e)})||c:a}function F(e,t,n,r){return r=function i(e,o,a){for(;a=lt[n[o]](a,e);)if(C.apply(a,D(t[o]))&&o)return(r=i(a,o-1,a))?r:a}(e,t.length-1,e)}function C(e,t,n,r,i,o,a,e,c,e,u,s){return c&&st[c]&&!st[c](this,u)||t&&"*"!==t&&this.tag&&this.tag.toLowerCase()!==t||r&&!L(o,this[i]||"",a)||n&&(s=n.match(/#([\w\-]+)/))&&s[1]!==this.id||n&&(n.match(/\.[\w\-]+/g)||[]).some(P.bind(this))?0:this}function L(e,t,n){return t.match(RegExp({"=":n,"^=":"^"+I(n),"$=":I(n)+"$","*=":I(n),"~=":"(?:^|\\s+)"+I(n)+"(?:\\s+|$)","|=":"^"+I(n)+"(-|$)"}[e]||"adnan^"))}function D(e){return e.match(ft)}function U(e){for(;e=e.previousSibling();)if(e.top)return e}function I(e){return e.replace(/([.*+?\^=!:${}()|\[\]\/\\])/,"\\$1")}function P(e){return!RegExp("(^|\\s+)"+e.slice(1)+"(\\s+|$)").test(this.class)}function O(e){return M(this,function(t){return"*"==e||t.tag==e},[])}function M(e,t,n){return(e.__scene__||e.children).forEach(function(e){M(e,t,n),t(e)&&n.push(e)})||n}function $(){return _t.reduce(function(e,t){return e[t.name]=G(t),t.prototype=Z(Object.create(mt[t.name]),vt),e},{})}function q(e){w.call(this,e,this.stroke(this.attr.stroke)),this.stroke(this.attr.stroke)}function z(e,t){var r=n.__scene__,i=r.indexOf(t);reverseEach(r.slice(i,r.push(0)),function(e,t){r[t]=r[t-1]}),r[i]=e}function N(e){return(this.types[e.tagName.toLowerCase()]||H)(e.tagName)}function X(e){var t=this.__scene__.indexOf(e);e=this.__scene__.splice(t,1)[0],e&&e.mesh.free(t)}function G(e){return function t(r){var i=new e;Z(i,t);var o=n.__scene__.push(i);return i.mesh.plus1(),i.attr=Object.create(yt),i.tag=r.toLowerCase(),i.parentNode=i.parentElement=n,i.indices="line"==e.name?[2*o,2*o+1]:"circle"==e.name?[4*o]:"rect"==e.name?[4*o]:[],"path"!==e.name&&(o+="line"==e.name?2:1),"line"==e.name&&(pt+=2),"circle"==e.name&&(dt+=1,i.fBuffer[4*dt]=1),"rect"==e.name&&(dt+=1,i.fBuffer[4*dt]=0),i}}function j(){}function Y(){Et.forEach(function(e){e()}),e.raf=ut(Y)}function H(){}function W(e){return e}function V(e){return this.push(e)}function K(e,t){for(var n in e)t(e[n],n,e)}function J(){return[-1,-1,1,-1,-1,1,1,1]}function Q(e){return(e.split(".").pop()||"").join().match(/mp4|ogg|webm/)}function Z(e,t){if(arguments.length>2)[].forEach.call(arguments,function(t){Z(e,t)});else for(var n in t)e[n]=t[n];return e}function et(){rt.bindTexture(rt.TEXTURE_2D,this.data),rt.pixelStorei(rt.UNPACK_FLIP_Y_WEBGL,!0),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_MAG_FILTER,rt.LINEAR),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_MIN_FILTER,rt.LINEAR),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_WRAP_S,rt.CLAMP_TO_EDGE),rt.texParameteri(rt.TEXTURE_2D,rt.TEXTURE_WRAP_T,rt.CLAMP_TO_EDGE),this.image?rt.texImage2D(rt.TEXTURE_2D,0,rt.RGBA,rt.RGBA,rt.UNSIGNED_BYTE,this.image):rt.texImage2D(rt.TEXTURE_2D,0,rt.RGBA,512,512,0,rt.RGBA,rt.UNSIGNED_BYTE,null)}function tt(e){var t=document.querySelector(e);return t?t:Z(Q?new Image:document.createElement("video"),{src:e})}function nt(e){return e.length>100}var rt,it;if(null==n&&(n=document.body.appendChild(Z(document.createElement("canvas"),{height:500,width:960}))),n="string"==typeof n?document.querySelector(n):n instanceof d3.selection?n.node():n,!n)return console.log("invalid selector");if(!n.getContext)return console.log(n,"is not a valid canvas");var ot={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};e.vertexShader=["precision mediump float;","uniform float clock;","uniform vec2 mouse;","uniform vec2 resolution;","uniform vec2 dates;","attribute vec4 pos;","attribute vec4 color;","attribute vec4 fugue;","varying float type;","varying vec4 v_stroke;","varying vec4 v_fill;","vec4 unpack_color(float col) {","    return vec4(mod(col / 256. / 256., 256.),","                mod(col / 256. , 256.),","                mod(col, 256.),","                256.)","                / 256.;","}","void main() {","    float time = clock / 1000.;","    float x = replace_x;","    float y = replace_y;","    float fill = color.x;","    float stroke = color.x;","    gl_Position = vec4(2. * (x / resolution.x) - 1., 1. - ((y / resolution.y) * 2.),  1., 1.);","    type = fugue.x;","    gl_PointSize =  replace_r;","    v_fill = unpack_color(fill);","    v_stroke = replace_stroke;","}"].join("\n\n"),e.fragmentShader=["precision mediump float;","uniform sampler2D texture;","uniform vec2 resolution;","uniform vec2 dates;","varying float type;","varying vec4 v_stroke;","varying vec4 v_fill;","void main() {","    float dist = distance(gl_PointCoord, vec2(0.5));","    if (type == 1. && dist > 0.5) discard;","    gl_FragColor = (v_stroke.x < 0.) ? texture2D(texture, gl_PointCoord) : v_stroke;","}"].join("\n");var at=!1;e.stop=function(){at=!0};var ct={appendChild:N,querySelectorAll:B,querySelector:function(e){return this.querySelectorAll(e)[0]},removeChild:X,insertBefore:z,__scene__:[],__pos__:[],__program__:void 0},ut=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};e.uniform=function(e,t){return it[e]?it[e](t):void 0},e.applyCSS=x;var st={},lt={" ":function(e){return e&&e!==__scene__&&e.parent()},">":function(e,t){return e&&e.parent()==t.parent()&&e.parent()},"~":function(e){return e&&e.previousSibling()},"+":function(e,t,n,r){return!e||(n=U(e))&&(r=U(t))&&n==r&&n}},ft=/^(\*|\w+)?(?:([\.\#]+[\w\-\.#]+)?)(\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\])?(:([\w\-]+)(\(['"]?([^()]+)['"]?\))?)?/,ht=!0,dt=0,pt=0,gt=!0,mt={circle:{cx:function(e){this.posBuffer[this.indices[0]+0]=e},cy:function(e){this.posBuffer[this.indices[0]+1]=e},r:function(e){this.posBuffer[this.indices[0]+2]=e},cz:function(e){this.posBuffer[this.indices[0]+3]=e},fill:function(e){this.colorBuffer[this.indices[0]]=0>e?e:r(e)},stroke:function(e){this.colorBuffer[this.indices[0]]=r(e)},opacity:function(){},posBuffer:null},ellipse:{cx:H,cy:H,rx:H,ry:H},rect:{fill:function(e){this.colorBuffer[this.indices[0]]=0>e?e:r(e)},x:function(e){this.posBuffer[this.indices[0]+0]=e},y:function(e){this.posBuffer[this.indices[0]+1]=e},width:function(e){this.posBuffer[this.indices[0]+2]=e},height:function(e){this.posBuffer[this.indices[0]+3]=e},rx:H,ry:H},image:{"xlink:href":H,height:H,width:H,x:H,y:H},line:{x1:function(e){this.posBuffer[2*this.indices[0]]=e},y1:function(e){this.posBuffer[2*this.indices[0]+1]=e},x2:function(e){this.posBuffer[2*this.indices[1]]=e},y2:function(e){this.posBuffer[2*this.indices[1]+1]=e},stroke:function(e){var t=r(e);this.indices.forEach(function(e){this.colorBuffer[4*e]=parseInt(t.toString().slice(1),16)},this)}},path:{d:q,pathLength:H,stroke:function(e){var t=r(e);this.indices.forEach(function(e){this.colorBuffer[e]=+parseInt(t.toString().slice(1),16)},this)}},polygon:{points:H},polyline:{points:H},g:{appendChild:function(e){this.children.push(N(e))},ctr:function(){this.children=[]}},text:{x:H,y:H,dx:H,dy:H}},vt={querySelectorAll:B,children:Object.freeze([]),ctr:G,querySelector:function(e){return this.querySelectorAll(e)[0]},createElementNS:W,insertBefore:H,ownerDocument:{createElementNS:function(e,t){return t}},render:function(){this.buffer&&drawFill(this),drawStroke(this)},previousSibling:function(){n.scene[n.__scene__.indexOf(this)-1]},nextSibling:function(){n.scene[n.__scene__.indexOf()+1]},parent:function(){return __scene__},gl:rt,transform:function(){},getAttribute:function(e){return this.attr[e]},setAttribute:function(e,t){t.ctr==At&&(t=+t),ht=!0,gt=!0,this.attr[e]=t,this[e]&&this[e](t)},style:{setProperty:H},removeAttribute:function(e){delete this.attr[e]},textContent:H,removeEventListener:H,addEventListener:j},_t=[function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],yt={rotation:[0,1],translate:[0,0],scale:[1,1],fill:0,stroke:0,"stroke-width":2,cx:0,cy:0,x:0,y:0,opacity:.999},bt=Date.now(),Et=[],wt=(Date.now(),{});e.frameCounter=wt;var xt={"null":[]};e.texture=function(e,n,r){var i=Object.create(At),o=rt.createTexture();return i.gl=rt,i.program=it,i.data=o,null==e&&(e=!1),nt(e)&&(i.program=u(rt,t,e,["pos"]),i.mesh=A(rt,"triangle_strip",J()),e=!1),e||(i.fbo=rt.createFramebuffer()),"string"==typeof e&&(e=tt(e)),Z(i,n,{image:e,width:e.width||512,height:e.height||512}),e||(i.update=k(i).update),r=r||null,(xt[r]||(xt[r]=[])).push(i),i.load()};var At={update:et,forEach:function(){},load:function(){var e=this.image;return e.complete||4==e.readyState?this.update():e.addEventListener&&e.addEventListener("load",this.update.bind(this)),this},unfold:function(){return e.shader()},repeat:function(){setInterval(this.update.bind(this),15)},appendChild:function(e){return(this.types[e.toLowerCase()]||H)(e)},valueOf:function(){return-1},querySelectorAll:B,__scene__:[],ownerDocument:{createElementNS:function(e,t){return t}}};return At=Z(Object.create(ct),At),d(n)}HTMLCanvasElement.prototype.appendChild=function(){},this.pathgl=e,e.stop=function(){},e.context=function(){},e.uniform=function(){},e.texture=function(){};var t=["precision mediump float;","attribute vec2 pos;","  void main() {","  gl_Position = vec4( pos.xy, 1.0 , 1.0);","  }"].join("\n"),n=[,"precision mediump float;","const vec3 TARGET = vec3( 0, 0, 0.01 );","uniform sampler2D uParticleData;","uniform vec2 uViewport;","vec4 texelAtOffet( vec2 offset ) { return texture2D( uParticleData, ( gl_FragCoord.xy + offset ) / uViewport ); }","void main() {","gl_FragColor = vec4(0.,0.,1.,1.); return;","int slot = int( mod( gl_FragCoord.x, 2.0 ) );","if ( slot == 0 ) { ","vec4 dataA = texelAtOffet( vec2( 0, 0 ) );","vec4 dataB = texelAtOffet( vec2( 1, 0 ) );","vec3 pos = dataA.xyz;","vec3 vel = dataB.xyz;","float phase = dataA.w;","if ( phase > 0.0 ) {","pos += vel * 0.005;","if ( length( TARGET - pos ) < 0.035 ) phase = 0.0;","    else phase += 0.1;","} else {","    pos = vec3(-1);","}","    gl_FragColor = vec4( pos, phase );","} else if ( slot == 1 ) { // velocity","vec4 dataA = texelAtOffet( vec2( -1, 0 ) );","vec4 dataB = texelAtOffet( vec2( 0, 0 ) );","vec3 pos = dataA.xyz;","vec3 vel = dataB.xyz;","float phase = dataA.w;","if ( phase > 0.0 ) {","vec3 delta = normalize( TARGET - pos );","vel += delta * 0.05;","    vel *= 0.991;","} else {","    vel = vec3(0);","}","    gl_FragColor = vec4( vel, 1.0 );","    }","}"].join("\n");e.sim={},e.sim.force=function(){return e.texture(n)}}();